<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Watering Schedule - GPT Ideas Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }
        .page-header { text-align: center; margin-bottom: 40px; padding: 40px 0; background: var(--gradient-primary); color: white; border-radius: var(--border-radius); position: relative; overflow: hidden; }
        .page-header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>'); opacity: 0.3; }
        .page-header-content { position: relative; z-index: 2; }
        .page-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 16px; font-family: 'Space Grotesk', sans-serif; }
        .page-meta { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .page-category-badge, .page-number-badge { padding: 8px 16px; background: rgba(255, 255, 255, 0.2); border-radius: 20px; font-size: 0.9rem; font-weight: 500; }
        .back-button { position: fixed; top: 20px; left: 20px; background: var(--primary-color); color: white; padding: 12px 20px; border-radius: var(--border-radius); text-decoration: none; font-weight: 500; transition: var(--transition); z-index: 1000; display: flex; align-items: center; gap: 8px; }
        .back-button:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        
        .plant-container { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .schedule-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        .management-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        
        .form-section { margin-bottom: 30px; }
        .form-section h3 { color: var(--primary-color); margin-bottom: 15px; border-bottom: 2px solid var(--border-color); padding-bottom: 8px; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: 500; margin-bottom: 8px; color: var(--text-primary); }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; transition: var(--transition); }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        .form-textarea { resize: vertical; min-height: 100px; }
        
        .today-tasks { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 30px; }
        .today-header { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .today-icon { width: 40px; height: 40px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .today-title { font-size: 1.2rem; font-weight: 600; color: var(--text-primary); }
        .task-list { display: flex; flex-direction: column; gap: 10px; }
        .task-item { background: white; padding: 12px; border-radius: var(--border-radius); border: 1px solid var(--border-color); display: flex; align-items: center; gap: 12px; }
        .task-checkbox { width: 18px; height: 18px; cursor: pointer; }
        .task-details { flex: 1; }
        .task-plant { font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .task-description { font-size: 0.9rem; color: var(--text-secondary); }
        .task-priority { padding: 4px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 500; }
        .task-priority.high { background: #fef3c7; color: #92400e; }
        .task-priority.medium { background: #dbeafe; color: #1e40af; }
        .task-priority.low { background: #dcfce7; color: #166534; }
        
        .upcoming-schedule { margin-bottom: 30px; }
        .schedule-day { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 15px; }
        .day-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .day-title { font-weight: 600; color: var(--text-primary); font-size: 1.1rem; }
        .day-count { background: var(--primary-color); color: white; padding: 4px 8px; border-radius: 10px; font-size: 0.8rem; }
        .day-tasks { display: flex; flex-direction: column; gap: 8px; }
        .day-task { background: white; padding: 10px; border-radius: var(--border-radius); border: 1px solid var(--border-color); font-size: 0.9rem; }
        
        .plant-form { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 20px; }
        .plant-form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .plant-list { max-height: 500px; overflow-y: auto; }
        .plant-card { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 15px; border: 1px solid var(--border-color); transition: var(--transition); }
        .plant-card:hover { background: var(--bg-tertiary); transform: translateY(-2px); box-shadow: var(--shadow-sm); }
        .plant-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px; }
        .plant-name { font-weight: 600; color: var(--text-primary); font-size: 1.1rem; margin-bottom: 5px; }
        .plant-species { font-size: 0.9rem; color: var(--text-secondary); }
        .plant-status { display: flex; gap: 10px; margin-bottom: 15px; }
        .status-badge { padding: 4px 8px; border-radius: 10px; font-size: 0.7rem; font-weight: 500; }
        .status-badge.healthy { background: #dcfce7; color: #166534; }
        .status-badge.needs-water { background: #fef3c7; color: #92400e; }
        .status-badge.overwatered { background: #fee2e2; color: #991b1b; }
        .status-badge.needs-fertilizer { background: #dbeafe; color: #1e40af; }
        .plant-info { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .info-item { text-align: center; }
        .info-value { font-size: 1.2rem; font-weight: 600; color: var(--primary-color); }
        .info-label { font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; }
        .plant-actions { display: flex; gap: 10px; }
        .plant-action-btn { padding: 8px 16px; border: none; border-radius: var(--border-radius); cursor: pointer; font-size: 0.8rem; font-weight: 500; transition: var(--transition); }
        .plant-action-btn.water { background: #dbeafe; color: #1e40af; }
        .plant-action-btn.water:hover { background: #bfdbfe; }
        .plant-action-btn.fertilize { background: #dcfce7; color: #166534; }
        .plant-action-btn.fertilize:hover { background: #bbf7d0; }
        .plant-action-btn.edit { background: var(--bg-tertiary); color: var(--text-primary); }
        .plant-action-btn.edit:hover { background: var(--primary-color); color: white; }
        .plant-action-btn.delete { background: #fee2e2; color: #991b1b; }
        .plant-action-btn.delete:hover { background: #fecaca; }
        
        .care-history { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-top: 20px; }
        .history-item { background: white; padding: 12px; border-radius: var(--border-radius); margin-bottom: 10px; border-left: 4px solid var(--primary-color); }
        .history-date { font-weight: 600; color: var(--text-primary); margin-bottom: 5px; }
        .history-action { font-size: 0.9rem; color: var(--text-secondary); }
        
        .action-buttons { display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; }
        .btn-primary { background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); border: 2px solid var(--border-color); padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-secondary:hover { background: var(--bg-tertiary); border-color: var(--primary-color); }
        
        .search-box { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; margin-bottom: 20px; }
        .search-box:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        
        .filter-controls { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-btn { padding: 8px 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); font-size: 0.9rem; }
        .filter-btn:hover { background: var(--bg-tertiary); }
        .filter-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        .plant-templates { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 20px; }
        .template-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        .template-card { background: white; padding: 15px; border-radius: var(--border-radius); border: 1px solid var(--border-color); cursor: pointer; transition: var(--transition); }
        .template-card:hover { background: var(--bg-tertiary); transform: translateY(-2px); box-shadow: var(--shadow-sm); }
        .template-title { font-weight: 600; color: var(--text-primary); margin-bottom: 8px; }
        .template-description { font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 10px; }
        .template-care { font-size: 0.7rem; color: var(--text-muted); }
        
        @media (max-width: 768px) {
            .page-title { font-size: 2rem; }
            .plant-container { grid-template-columns: 1fr; }
            .back-button { position: relative; top: auto; left: auto; margin-bottom: 20px; display: inline-block; }
            .plant-form-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Plant Watering Schedule</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Home & Lifestyle</span>
                        <span class="page-number-badge">Page #75</span>
                    </div>
                </div>
            </div>
            
            <div class="plant-container">
                <div class="schedule-panel">
                    <div class="form-section">
                        <h3>Today's Tasks</h3>
                        
                        <div class="today-tasks" id="todayTasks">
                            <div class="today-header">
                                <div class="today-icon">
                                    <i class="fas fa-seedling"></i>
                                </div>
                                <div class="today-title">Plants that need attention today</div>
                            </div>
                            <div class="task-list" id="todayTaskList">
                                <!-- Today's tasks will be populated here -->
                            </div>
                        </div>
                        
                        <div class="upcoming-schedule" id="upcomingSchedule">
                            <!-- Upcoming schedule will be populated here -->
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-primary" onclick="markAllCompleted()">
                                <i class="fas fa-check-double"></i> Mark All Completed
                            </button>
                            <button class="btn-secondary" onclick="exportSchedule()">
                                <i class="fas fa-download"></i> Export Schedule
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="management-panel">
                    <div class="form-section">
                        <h3>Plant Management</h3>
                        
                        <div class="plant-form">
                            <h4>Add New Plant</h4>
                            <div class="plant-form-grid">
                                <div class="form-group">
                                    <label class="form-label">Plant Name</label>
                                    <input type="text" class="form-input" id="plantName" placeholder="e.g., Monstera Deliciosa">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Species</label>
                                    <input type="text" class="form-input" id="plantSpecies" placeholder="e.g., Swiss Cheese Plant">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Watering Frequency (days)</label>
                                    <input type="number" class="form-input" id="wateringFrequency" value="7" min="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Fertilizing Frequency (days)</label>
                                    <input type="number" class="form-input" id="fertilizingFrequency" value="30" min="1">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Location</label>
                                    <input type="text" class="form-input" id="plantLocation" placeholder="e.g., Living room window">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Notes</label>
                                    <textarea class="form-textarea" id="plantNotes" placeholder="Any special care instructions..."></textarea>
                                </div>
                            </div>
                            <button class="btn-primary" onclick="addPlant()">
                                <i class="fas fa-plus"></i> Add Plant
                            </button>
                        </div>
                        
                        <div class="filter-controls">
                            <button class="filter-btn active" data-filter="all">All Plants</button>
                            <button class="filter-btn" data-filter="needs-water">Needs Water</button>
                            <button class="filter-btn" data-filter="healthy">Healthy</button>
                            <button class="filter-btn" data-filter="needs-fertilizer">Needs Fertilizer</button>
                        </div>
                        
                        <input type="text" class="search-box" id="searchBox" placeholder="Search plants...">
                        
                        <div class="plant-list" id="plantList">
                            <!-- Plants will be populated here -->
                        </div>
                        
                        <div class="plant-templates">
                            <h4>Plant Care Templates</h4>
                            <div class="template-grid" id="templateGrid">
                                <!-- Templates will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Plant data structure
        let plants = [];
        let careHistory = [];
        let activeFilter = 'all';
        
        // Plant care templates
        const plantTemplates = [
            {
                name: 'Succulent',
                description: 'Low-maintenance desert plants',
                care: {
                    watering: 14,
                    fertilizing: 60,
                    notes: 'Water sparingly, well-draining soil, bright indirect light'
                }
            },
            {
                name: 'Tropical Plant',
                description: 'Humidity-loving plants like Monstera',
                care: {
                    watering: 5,
                    fertilizing: 30,
                    notes: 'Keep soil moist, high humidity, bright indirect light'
                }
            },
            {
                name: 'Cactus',
                description: 'Desert plants with minimal water needs',
                care: {
                    watering: 21,
                    fertilizing: 90,
                    notes: 'Minimal water, sandy soil, full sun'
                }
            },
            {
                name: 'Herb Garden',
                description: 'Culinary herbs for cooking',
                care: {
                    watering: 3,
                    fertilizing: 21,
                    notes: 'Keep soil moist, regular pruning, full sun'
                }
            }
        ];
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            renderTodayTasks();
            renderUpcomingSchedule();
            renderPlants();
            populateTemplates();
        });
        
        function loadData() {
            const savedPlants = localStorage.getItem('plantData');
            const savedHistory = localStorage.getItem('careHistory');
            
            if (savedPlants) {
                plants = JSON.parse(savedPlants);
            } else {
                // Load sample plants
                plants = [
                    {
                        id: 1,
                        name: 'Monstera Deliciosa',
                        species: 'Swiss Cheese Plant',
                        wateringFrequency: 5,
                        fertilizingFrequency: 30,
                        location: 'Living room window',
                        notes: 'Loves humidity, keep away from direct sunlight',
                        lastWatered: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),
                        lastFertilized: new Date(Date.now() - 25 * 24 * 60 * 60 * 1000).toISOString(),
                        status: 'healthy',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: 'Snake Plant',
                        species: 'Sansevieria Trifasciata',
                        wateringFrequency: 14,
                        fertilizingFrequency: 60,
                        location: 'Bedroom corner',
                        notes: 'Very low maintenance, can go weeks without water',
                        lastWatered: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),
                        lastFertilized: new Date(Date.now() - 45 * 24 * 60 * 60 * 1000).toISOString(),
                        status: 'healthy',
                        createdAt: new Date().toISOString()
                    }
                ];
            }
            
            if (savedHistory) {
                careHistory = JSON.parse(savedHistory);
            }
        }
        
        function renderTodayTasks() {
            const todayTaskList = document.getElementById('todayTaskList');
            todayTaskList.innerHTML = '';
            
            const today = new Date();
            const todayTasks = [];
            
            plants.forEach(plant => {
                const daysSinceWatered = Math.floor((today - new Date(plant.lastWatered)) / (1000 * 60 * 60 * 24));
                const daysSinceFertilized = Math.floor((today - new Date(plant.lastFertilized)) / (1000 * 60 * 60 * 24));
                
                if (daysSinceWatered >= plant.wateringFrequency) {
                    todayTasks.push({
                        type: 'water',
                        plant: plant.name,
                        description: `Needs watering (${daysSinceWatered} days since last)`,
                        priority: daysSinceWatered > plant.wateringFrequency + 3 ? 'high' : 'medium',
                        plantId: plant.id
                    });
                }
                
                if (daysSinceFertilized >= plant.fertilizingFrequency) {
                    todayTasks.push({
                        type: 'fertilize',
                        plant: plant.name,
                        description: `Needs fertilizing (${daysSinceFertilized} days since last)`,
                        priority: daysSinceFertilized > plant.fertilizingFrequency + 7 ? 'high' : 'low',
                        plantId: plant.id
                    });
                }
            });
            
            if (todayTasks.length === 0) {
                todayTaskList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">All plants are well cared for today! ðŸŒ±</p>';
                return;
            }
            
            todayTasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.className = 'task-item';
                taskElement.innerHTML = `
                    <input type="checkbox" class="task-checkbox" onchange="completeTask(${task.plantId}, '${task.type}')">
                    <div class="task-details">
                        <div class="task-plant">${task.plant}</div>
                        <div class="task-description">${task.description}</div>
                    </div>
                    <span class="task-priority ${task.priority}">${task.priority.toUpperCase()}</span>
                `;
                todayTaskList.appendChild(taskElement);
            });
        }
        
        function renderUpcomingSchedule() {
            const upcomingSchedule = document.getElementById('upcomingSchedule');
            upcomingSchedule.innerHTML = '';
            
            const next7Days = [];
            for (let i = 1; i <= 7; i++) {
                const date = new Date();
                date.setDate(date.getDate() + i);
                next7Days.push(date);
            }
            
            next7Days.forEach(date => {
                const dayTasks = [];
                
                plants.forEach(plant => {
                    const daysSinceWatered = Math.floor((date - new Date(plant.lastWatered)) / (1000 * 60 * 60 * 24));
                    const daysSinceFertilized = Math.floor((date - new Date(plant.lastFertilized)) / (1000 * 60 * 60 * 24));
                    
                    if (daysSinceWatered >= plant.wateringFrequency) {
                        dayTasks.push(`Water ${plant.name}`);
                    }
                    
                    if (daysSinceFertilized >= plant.fertilizingFrequency) {
                        dayTasks.push(`Fertilize ${plant.name}`);
                    }
                });
                
                if (dayTasks.length > 0) {
                    const dayElement = document.createElement('div');
                    dayElement.className = 'schedule-day';
                    dayElement.innerHTML = `
                        <div class="day-header">
                            <div class="day-title">${date.toLocaleDateString('en-US', { weekday: 'long', month: 'short', day: 'numeric' })}</div>
                            <div class="day-count">${dayTasks.length} tasks</div>
                        </div>
                        <div class="day-tasks">
                            ${dayTasks.map(task => `<div class="day-task">${task}</div>`).join('')}
                        </div>
                    `;
                    upcomingSchedule.appendChild(dayElement);
                }
            });
        }
        
        function renderPlants() {
            const plantList = document.getElementById('plantList');
            plantList.innerHTML = '';
            
            const filteredPlants = filterPlants(plants);
            
            if (filteredPlants.length === 0) {
                plantList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No plants found</p>';
                return;
            }
            
            filteredPlants.forEach(plant => {
                const plantElement = createPlantElement(plant);
                plantList.appendChild(plantElement);
            });
        }
        
        function filterPlants(plants) {
            switch (activeFilter) {
                case 'needs-water':
                    return plants.filter(p => {
                        const daysSinceWatered = Math.floor((new Date() - new Date(p.lastWatered)) / (1000 * 60 * 60 * 24));
                        return daysSinceWatered >= p.wateringFrequency;
                    });
                case 'healthy':
                    return plants.filter(p => p.status === 'healthy');
                case 'needs-fertilizer':
                    return plants.filter(p => {
                        const daysSinceFertilized = Math.floor((new Date() - new Date(p.lastFertilized)) / (1000 * 60 * 60 * 24));
                        return daysSinceFertilized >= p.fertilizingFrequency;
                    });
                default:
                    return plants;
            }
        }
        
        function createPlantElement(plant) {
            const plantElement = document.createElement('div');
            plantElement.className = 'plant-card';
            plantElement.dataset.id = plant.id;
            
            const daysSinceWatered = Math.floor((new Date() - new Date(plant.lastWatered)) / (1000 * 60 * 60 * 24));
            const daysSinceFertilized = Math.floor((new Date() - new Date(plant.lastFertilized)) / (1000 * 60 * 60 * 24));
            
            let status = 'healthy';
            if (daysSinceWatered > plant.wateringFrequency + 3) status = 'needs-water';
            else if (daysSinceWatered < plant.wateringFrequency - 2) status = 'overwatered';
            else if (daysSinceFertilized > plant.fertilizingFrequency + 7) status = 'needs-fertilizer';
            
            const statusText = {
                'healthy': 'Healthy',
                'needs-water': 'Needs Water',
                'overwatered': 'Overwatered',
                'needs-fertilizer': 'Needs Fertilizer'
            };
            
            plantElement.innerHTML = `
                <div class="plant-header">
                    <div>
                        <div class="plant-name">${plant.name}</div>
                        <div class="plant-species">${plant.species}</div>
                    </div>
                    <div class="plant-status">
                        <span class="status-badge ${status}">${statusText[status]}</span>
                    </div>
                </div>
                <div class="plant-info">
                    <div class="info-item">
                        <div class="info-value">${daysSinceWatered}</div>
                        <div class="info-label">Days Since Watered</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${daysSinceFertilized}</div>
                        <div class="info-label">Days Since Fertilized</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${plant.wateringFrequency}</div>
                        <div class="info-label">Water Every (days)</div>
                    </div>
                    <div class="info-item">
                        <div class="info-value">${plant.fertilizingFrequency}</div>
                        <div class="info-label">Fertilize Every (days)</div>
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <strong>Location:</strong> ${plant.location}<br>
                    <strong>Notes:</strong> ${plant.notes}
                </div>
                <div class="plant-actions">
                    <button class="plant-action-btn water" onclick="waterPlant(${plant.id})">
                        <i class="fas fa-tint"></i> Water
                    </button>
                    <button class="plant-action-btn fertilize" onclick="fertilizePlant(${plant.id})">
                        <i class="fas fa-seedling"></i> Fertilize
                    </button>
                    <button class="plant-action-btn edit" onclick="editPlant(${plant.id})">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="plant-action-btn delete" onclick="deletePlant(${plant.id})">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            
            return plantElement;
        }
        
        function addPlant() {
            const name = document.getElementById('plantName').value.trim();
            const species = document.getElementById('plantSpecies').value.trim();
            const wateringFrequency = parseInt(document.getElementById('wateringFrequency').value);
            const fertilizingFrequency = parseInt(document.getElementById('fertilizingFrequency').value);
            const location = document.getElementById('plantLocation').value.trim();
            const notes = document.getElementById('plantNotes').value.trim();
            
            if (!name || !species) {
                alert('Please enter plant name and species');
                return;
            }
            
            const newPlant = {
                id: Date.now(),
                name,
                species,
                wateringFrequency,
                fertilizingFrequency,
                location,
                notes,
                lastWatered: new Date().toISOString(),
                lastFertilized: new Date().toISOString(),
                status: 'healthy',
                createdAt: new Date().toISOString()
            };
            
            plants.push(newPlant);
            saveData();
            renderTodayTasks();
            renderUpcomingSchedule();
            renderPlants();
            
            // Clear form
            document.getElementById('plantName').value = '';
            document.getElementById('plantSpecies').value = '';
            document.getElementById('wateringFrequency').value = '7';
            document.getElementById('fertilizingFrequency').value = '30';
            document.getElementById('plantLocation').value = '';
            document.getElementById('plantNotes').value = '';
        }
        
        function waterPlant(plantId) {
            const plant = plants.find(p => p.id === plantId);
            if (plant) {
                plant.lastWatered = new Date().toISOString();
                plant.status = 'healthy';
                
                careHistory.push({
                    id: Date.now(),
                    plantId,
                    plantName: plant.name,
                    action: 'watered',
                    date: new Date().toISOString()
                });
                
                saveData();
                renderTodayTasks();
                renderUpcomingSchedule();
                renderPlants();
            }
        }
        
        function fertilizePlant(plantId) {
            const plant = plants.find(p => p.id === plantId);
            if (plant) {
                plant.lastFertilized = new Date().toISOString();
                
                careHistory.push({
                    id: Date.now(),
                    plantId,
                    plantName: plant.name,
                    action: 'fertilized',
                    date: new Date().toISOString()
                });
                
                saveData();
                renderTodayTasks();
                renderUpcomingSchedule();
                renderPlants();
            }
        }
        
        function completeTask(plantId, action) {
            if (action === 'water') {
                waterPlant(plantId);
            } else if (action === 'fertilize') {
                fertilizePlant(plantId);
            }
        }
        
        function editPlant(plantId) {
            const plant = plants.find(p => p.id === plantId);
            if (plant) {
                document.getElementById('plantName').value = plant.name;
                document.getElementById('plantSpecies').value = plant.species;
                document.getElementById('wateringFrequency').value = plant.wateringFrequency;
                document.getElementById('fertilizingFrequency').value = plant.fertilizingFrequency;
                document.getElementById('plantLocation').value = plant.location;
                document.getElementById('plantNotes').value = plant.notes;
                
                // Remove the old plant
                deletePlant(plantId);
                
                // Focus on name input for editing
                document.getElementById('plantName').focus();
            }
        }
        
        function deletePlant(plantId) {
            if (confirm('Are you sure you want to delete this plant?')) {
                plants = plants.filter(p => p.id !== plantId);
                careHistory = careHistory.filter(h => h.plantId !== plantId);
                saveData();
                renderTodayTasks();
                renderUpcomingSchedule();
                renderPlants();
            }
        }
        
        function populateTemplates() {
            const templateGrid = document.getElementById('templateGrid');
            templateGrid.innerHTML = '';
            
            plantTemplates.forEach(template => {
                const templateCard = document.createElement('div');
                templateCard.className = 'template-card';
                templateCard.innerHTML = `
                    <div class="template-title">${template.name}</div>
                    <div class="template-description">${template.description}</div>
                    <div class="template-care">
                        Water every ${template.care.watering} days â€¢ Fertilize every ${template.care.fertilizing} days
                    </div>
                `;
                templateCard.onclick = () => loadTemplate(template);
                templateGrid.appendChild(templateCard);
            });
        }
        
        function loadTemplate(template) {
            if (confirm(`Load "${template.name}" template? This will set the default care schedule.`)) {
                document.getElementById('wateringFrequency').value = template.care.watering;
                document.getElementById('fertilizingFrequency').value = template.care.fertilizing;
                document.getElementById('plantNotes').value = template.care.notes;
                alert(`Template "${template.name}" loaded! Fill in the plant name and species, then click Add Plant.`);
            }
        }
        
        function markAllCompleted() {
            if (confirm('Mark all today\'s tasks as completed?')) {
                const todayTasks = document.querySelectorAll('#todayTaskList .task-item');
                todayTasks.forEach(task => {
                    const checkbox = task.querySelector('.task-checkbox');
                    if (!checkbox.checked) {
                        checkbox.checked = true;
                        const plantId = parseInt(task.dataset.plantId);
                        const action = task.querySelector('.task-description').textContent.includes('watering') ? 'water' : 'fertilize';
                        completeTask(plantId, action);
                    }
                });
            }
        }
        
        function exportSchedule() {
            if (plants.length === 0) {
                alert('No plants to export!');
                return;
            }
            
            let exportText = 'PLANT CARE SCHEDULE\n';
            exportText += 'Generated on: ' + new Date().toLocaleDateString() + '\n\n';
            
            exportText += 'PLANTS:\n';
            plants.forEach(plant => {
                const daysSinceWatered = Math.floor((new Date() - new Date(plant.lastWatered)) / (1000 * 60 * 60 * 24));
                const daysSinceFertilized = Math.floor((new Date() - new Date(plant.lastFertilized)) / (1000 * 60 * 60 * 24));
                
                exportText += `${plant.name} (${plant.species})\n`;
                exportText += `Location: ${plant.location}\n`;
                exportText += `Water every: ${plant.wateringFrequency} days (${daysSinceWatered} days ago)\n`;
                exportText += `Fertilize every: ${plant.fertilizingFrequency} days (${daysSinceFertilized} days ago)\n`;
                exportText += `Notes: ${plant.notes}\n\n`;
            });
            
            exportText += `Total Plants: ${plants.length}\n`;
            exportText += `Total Care Actions: ${careHistory.length}`;
            
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'plant-care-schedule.txt';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function saveData() {
            localStorage.setItem('plantData', JSON.stringify(plants));
            localStorage.setItem('careHistory', JSON.stringify(careHistory));
        }
        
        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                activeFilter = this.dataset.filter;
                renderPlants();
            });
        });
        
        // Search functionality
        document.getElementById('searchBox').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const plantCards = document.querySelectorAll('.plant-card');
            
            plantCards.forEach(card => {
                const name = card.querySelector('.plant-name').textContent.toLowerCase();
                const species = card.querySelector('.plant-species').textContent.toLowerCase();
                const location = card.textContent.toLowerCase();
                
                if (name.includes(searchTerm) || species.includes(searchTerm) || location.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
