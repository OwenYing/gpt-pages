<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poem or Haiku Creator - GPT Static Pages</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .poetry-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .poem-display {
            background: var(--bg-tertiary);
            padding: 50px;
            border-radius: 20px;
            text-align: center;
            margin: 40px 0;
            border: 3px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .poem-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(99, 102, 241, 0.1) 50%, transparent 70%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .poem-display.animate::before {
            transform: translateX(100%);
        }
        
        .poem-content {
            position: relative;
            z-index: 2;
            max-width: 600px;
        }
        
        .poem-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .poem-text {
            font-size: 1.3rem;
            color: var(--text-primary);
            line-height: 1.8;
            margin-bottom: 20px;
            white-space: pre-line;
            font-family: 'Inter', serif;
        }
        
        .poem-type {
            display: inline-block;
            padding: 8px 16px;
            background: var(--primary-color);
            color: white;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            margin-bottom: 20px;
        }
        
        .poem-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .poem-btn {
            padding: 15px 30px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .poem-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .poem-btn.primary {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .poem-btn.primary:hover {
            background: var(--primary-dark);
        }
        
        .poem-filters {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .filters-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            text-align: center;
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .filter-group {
            text-align: center;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .filter-group select, .filter-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }
        
        .filter-group select:focus, .filter-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .category-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .category-btn {
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .category-btn:hover {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }
        
        .category-btn.active {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }
        
        .poem-history {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .history-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            text-align: center;
        }
        
        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .history-item {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .history-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .history-title-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .history-poem {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: 15px;
            white-space: pre-line;
            max-height: 100px;
            overflow: hidden;
        }
        
        .history-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .history-type {
            background: var(--primary-color);
            color: white;
            padding: 4px 8px;
            border-radius: 10px;
        }
        
        .poetry-tools {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .tools-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            text-align: center;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .tool-item {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .tool-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-3px);
        }
        
        .tool-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .tool-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .tool-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .tool-btn {
            padding: 10px 20px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .tool-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .poem-stats {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stats-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
        }
        
        .stat-item {
            background: var(--bg-tertiary);
            padding: 20px;
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .page-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        
        .page-header-content {
            position: relative;
            z-index: 2;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .page-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .page-category-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .page-number-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .content-section {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }
        
        @media (max-width: 768px) {
            .poem-display {
                padding: 30px 20px;
            }
            
            .poem-text {
                font-size: 1.1rem;
            }
            
            .poem-actions {
                flex-direction: column;
                align-items: center;
            }
            
            .poem-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .category-filters {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .history-grid {
                grid-template-columns: 1fr;
            }
            
            .tools-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Poem or Haiku Creator</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Writing & Creativity</span>
                        <span class="page-number-badge">Page #44</span>
                    </div>
                </div>
            </div>

            <!-- Introduction -->
            <div class="content-section">
                <p>Unleash your inner poet with our creative poetry generator! Create beautiful poems, haikus, and verses inspired by themes, emotions, and nature. Perfect for writers, students, and anyone looking to express themselves through verse.</p>
            </div>

            <!-- Poem Display -->
            <div class="content-section">
                <div class="poetry-container">
                    <div class="poem-display" id="poemDisplay">
                        <div class="poem-content">
                            <div class="poem-title" id="poemTitle">Click Generate to Create Poetry</div>
                            <div class="poem-text" id="poemText">Ready to discover the magic of words?</div>
                            <div class="poem-type" id="poemType">Haiku</div>
                            
                            <div class="poem-actions">
                                <button class="poem-btn primary" id="generateBtn">
                                    <i class="fas fa-magic"></i> Generate Poem
                                </button>
                                <button class="poem-btn" id="favoriteBtn" style="display: none;">
                                    <i class="fas fa-heart"></i> Favorite
                                </button>
                                <button class="poem-btn" id="copyBtn" style="display: none;">
                                    <i class="fas fa-copy"></i> Copy
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Poem Filters -->
            <div class="content-section">
                <div class="poem-filters">
                    <div class="filters-title">Customize Your Poetry</div>
                    
                    <div class="filters-grid">
                        <div class="filter-group">
                            <label for="poemTypeFilter">Poem Type</label>
                            <select id="poemTypeFilter">
                                <option value="all">All Types</option>
                                <option value="haiku">Haiku</option>
                                <option value="sonnet">Sonnet</option>
                                <option value="free-verse">Free Verse</option>
                                <option value="limerick">Limerick</option>
                                <option value="acrostic">Acrostic</option>
                                <option value="couplet">Couplet</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label for="themeFilter">Theme</label>
                            <select id="themeFilter">
                                <option value="all">All Themes</option>
                                <option value="nature">Nature</option>
                                <option value="love">Love & Romance</option>
                                <option value="emotions">Emotions</option>
                                <option value="life">Life & Philosophy</option>
                                <option value="seasons">Seasons</option>
                                <option value="adventure">Adventure</option>
                                <option value="peace">Peace & Tranquility</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label for="moodFilter">Mood</label>
                            <select id="moodFilter">
                                <option value="all">Any Mood</option>
                                <option value="joyful">Joyful</option>
                                <option value="melancholy">Melancholy</option>
                                <option value="peaceful">Peaceful</option>
                                <option value="passionate">Passionate</option>
                                <option value="mysterious">Mysterious</option>
                                <option value="inspiring">Inspiring</option>
                                <option value="contemplative">Contemplative</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label for="lengthFilter">Length</label>
                            <select id="poemLengthFilter">
                                <option value="all">Any Length</option>
                                <option value="short">Short (1-4 lines)</option>
                                <option value="medium">Medium (5-12 lines)</option>
                                <option value="long">Long (13+ lines)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="category-filters">
                        <button class="category-btn active" data-category="all">All Styles</button>
                        <button class="category-btn" data-category="classical">Classical</button>
                        <button class="category-btn" data-category="modern">Modern</button>
                        <button class="category-btn" data-category="romantic">Romantic</button>
                        <button class="category-btn" data-category="minimalist">Minimalist</button>
                        <button class="category-btn" data-category="experimental">Experimental</button>
                    </div>
                </div>
            </div>

            <!-- Poetry Tools -->
            <div class="content-section">
                <div class="poetry-tools">
                    <div class="tools-title">Poetry Creation Tools</div>
                    
                    <div class="tools-grid">
                        <div class="tool-item">
                            <div class="tool-icon">
                                <i class="fas fa-feather-alt"></i>
                            </div>
                            <div class="tool-name">Rhyme Finder</div>
                            <div class="tool-description">Find perfect rhymes and near-rhymes for your poetry to enhance musicality.</div>
                            <button class="tool-btn" onclick="findRhymes()">Find Rhymes</button>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-icon">
                                <i class="fas fa-music"></i>
                            </div>
                            <div class="tool-name">Syllable Counter</div>
                            <div class="tool-description">Count syllables in your text to maintain proper meter and structure.</div>
                            <button class="tool-btn" onclick="countSyllables()">Count Syllables</button>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-icon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="tool-name">Inspiration Prompts</div>
                            <div class="tool-description">Get creative prompts and ideas to spark your poetic imagination.</div>
                            <button class="tool-btn" onclick="getInspiration()">Get Inspired</button>
                        </div>
                        
                        <div class="tool-item">
                            <div class="tool-icon">
                                <i class="fas fa-bookmark"></i>
                            </div>
                            <div class="tool-name">Poetry Library</div>
                            <div class="tool-description">Save and organize your favorite poems for future reference and inspiration.</div>
                            <button class="tool-btn" onclick="showPoetryLibrary()">View Library</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Poetry Statistics -->
            <div class="content-section">
                <div class="poem-stats">
                    <div class="stats-title">Your Poetry Journey</div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalPoems">0</div>
                            <div class="stat-label">Poems Created</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="favoritePoems">0</div>
                            <div class="stat-label">Favorites</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="uniqueThemes">0</div>
                            <div class="stat-label">Themes Explored</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="totalLines">0</div>
                            <div class="stat-label">Lines Written</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Poem History -->
            <div class="content-section">
                <div class="poem-history">
                    <div class="history-title">Recent Poems</div>
                    
                    <div class="history-grid" id="historyGrid">
                        <!-- History items will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Poetry database
        const poetryDatabase = {
            haiku: {
                nature: [
                    {
                        title: "Morning Dew",
                        text: "Morning dew glistens\nOn spider's web so fragile\nNature's jewelry",
                        theme: "nature",
                        mood: "peaceful",
                        style: "classical"
                    },
                    {
                        title: "Mountain Stream",
                        text: "Mountain stream flows down\nOver rocks and ancient roots\nWater finds its way",
                        theme: "nature",
                        mood: "peaceful",
                        style: "classical"
                    },
                    {
                        title: "Cherry Blossoms",
                        text: "Cherry blossoms fall\nLike pink snow in springtime breeze\nPetals dance and swirl",
                        theme: "nature",
                        mood: "joyful",
                        style: "classical"
                    }
                ],
                seasons: [
                    {
                        title: "Autumn Leaves",
                        text: "Autumn leaves descend\nGolden carpet on the ground\nWinter's prelude",
                        theme: "seasons",
                        mood: "melancholy",
                        style: "classical"
                    },
                    {
                        title: "Winter Silence",
                        text: "Snow blankets the earth\nSilence fills the frozen air\nPeace in stillness",
                        theme: "seasons",
                        mood: "peaceful",
                        style: "minimalist"
                    }
                ],
                emotions: [
                    {
                        title: "Inner Peace",
                        text: "Mind like still water\nReflecting sky's endless blue\nCalmness within",
                        theme: "emotions",
                        mood: "peaceful",
                        style: "minimalist"
                    }
                ]
            },
            sonnet: {
                love: [
                    {
                        title: "Eternal Love",
                        text: "Shall I compare thee to a summer's day?\nThou art more lovely and more temperate.\nRough winds do shake the darling buds of May,\nAnd summer's lease hath all too short a date.\n\nSometime too hot the eye of heaven shines,\nAnd often is his gold complexion dimmed;\nAnd every fair from fair sometime declines,\nBy chance or nature's changing course untrimmed.\n\nBut thy eternal summer shall not fade,\nNor lose possession of that fair thou ow'st;\nNor shall death brag thou wander'st in his shade,\nWhen in eternal lines to time thou grow'st.\n\nSo long as men can breathe or eyes can see,\nSo long lives this, and this gives life to thee.",
                        theme: "love",
                        mood: "passionate",
                        style: "classical"
                    }
                ],
                life: [
                    {
                        title: "The Road Not Taken",
                        text: "Two roads diverged in a yellow wood,\nAnd sorry I could not travel both\nAnd be one traveler, long I stood\nAnd looked down one as far as I could\nTo where it bent in the undergrowth;\n\nThen took the other, as just as fair,\nAnd having perhaps the better claim,\nBecause it was grassy and wanted wear;\nThough as for that the passing there\nHad worn them really about the same.\n\nAnd both that morning equally lay\nIn leaves no step had trodden black.\nOh, I kept the first for another day!\nYet knowing how way leads on to way,\nI doubted if I should ever come back.\n\nI shall be telling this with a sigh\nSomewhere ages and ages hence:\nTwo roads diverged in a wood, and I—\nI took the one less traveled by,\nAnd that has made all the difference.",
                        theme: "life",
                        mood: "contemplative",
                        style: "modern"
                    }
                ]
            },
            "free-verse": {
                nature: [
                    {
                        title: "Ocean Waves",
                        text: "The ocean waves crash against the shore\nLike ancient memories returning home\nEach wave a story, each tide a song\nOf the deep blue mystery that calls to us all",
                        theme: "nature",
                        mood: "mysterious",
                        style: "modern"
                    },
                    {
                        title: "Forest Whispers",
                        text: "In the heart of the forest\nWhere sunlight filters through green\nAncient trees whisper secrets\nOf time and growth and change",
                        theme: "nature",
                        mood: "peaceful",
                        style: "minimalist"
                    }
                ],
                emotions: [
                    {
                        title: "Joy Unbound",
                        text: "Joy bubbles up like spring water\nPure and clear and unstoppable\nIt fills every corner of my being\nUntil I am overflowing with light",
                        theme: "emotions",
                        mood: "joyful",
                        style: "modern"
                    }
                ]
            },
            limerick: {
                adventure: [
                    {
                        title: "The Brave Explorer",
                        text: "There once was a brave explorer\nWho ventured where none dared to go\nThrough jungles and caves\nHe found ancient graves\nAnd treasures that made his eyes glow!",
                        theme: "adventure",
                        mood: "joyful",
                        style: "classical"
                    }
                ],
                life: [
                    {
                        title: "The Wise Old Sage",
                        text: "There once was a wise old sage\nWho lived to a very old age\nHe said with a grin\nAs he poured out some gin\n'Life's too short to be filled with rage!'",
                        theme: "life",
                        mood: "joyful",
                        style: "classical"
                    }
                ]
            }
        };

        let currentPoem = null;
        let poemHistory = JSON.parse(localStorage.getItem('poetryHistory')) || [];
        let favoritePoems = JSON.parse(localStorage.getItem('favoritePoems')) || [];
        let poetryStats = JSON.parse(localStorage.getItem('poetryStats')) || {
            totalPoems: 0,
            favoritePoems: 0,
            uniqueThemes: 0,
            totalLines: 0
        };

        let selectedType = 'all';
        let selectedTheme = 'all';
        let selectedMood = 'all';
        let selectedLength = 'all';
        let selectedStyle = 'all';

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateStats();
            renderHistory();
        });

        function setupEventListeners() {
            // Generate button
            document.getElementById('generateBtn').addEventListener('click', generatePoem);
            
            // Favorite button
            document.getElementById('favoriteBtn').addEventListener('click', toggleFavorite);
            
            // Copy button
            document.getElementById('copyBtn').addEventListener('click', copyPoem);
            
            // Filters
            document.getElementById('poemTypeFilter').addEventListener('change', function() {
                selectedType = this.value;
            });
            
            document.getElementById('themeFilter').addEventListener('change', function() {
                selectedTheme = this.value;
            });
            
            document.getElementById('moodFilter').addEventListener('change', function() {
                selectedMood = this.value;
            });
            
            document.getElementById('poemLengthFilter').addEventListener('change', function() {
                selectedLength = this.value;
            });
            
            // Category buttons
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedStyle = this.dataset.category;
                });
            });
        }

        function generatePoem() {
            const poemDisplay = document.getElementById('poemDisplay');
            poemDisplay.classList.add('animate');
            
            setTimeout(() => {
                const poem = createRandomPoem();
                displayPoem(poem);
                addToHistory(poem);
                updateStats();
                poemDisplay.classList.remove('animate');
            }, 300);
        }

        function createRandomPoem() {
            let availableTypes = selectedType === 'all' ? Object.keys(poetryDatabase) : [selectedType];
            let availableThemes = selectedTheme === 'all' ? Object.keys(poetryDatabase[availableTypes[0]] || {}) : [selectedTheme];
            
            // Find a valid type-theme combination
            let validCombinations = [];
            availableTypes.forEach(type => {
                if (poetryDatabase[type]) {
                    availableThemes.forEach(theme => {
                        if (poetryDatabase[type][theme]) {
                            validCombinations.push({ type, theme });
                        }
                    });
                }
            });
            
            if (validCombinations.length === 0) {
                // Fallback to any available combination
                Object.keys(poetryDatabase).forEach(type => {
                    Object.keys(poetryDatabase[type]).forEach(theme => {
                        validCombinations.push({ type, theme });
                    });
                });
            }
            
            const randomCombination = validCombinations[Math.floor(Math.random() * validCombinations.length)];
            const poems = poetryDatabase[randomCombination.type][randomCombination.theme];
            const randomPoem = poems[Math.floor(Math.random() * poems.length)];
            
            return {
                ...randomPoem,
                type: randomCombination.type,
                timestamp: Date.now(),
                id: Date.now()
            };
        }

        function displayPoem(poem) {
            currentPoem = poem;
            
            document.getElementById('poemTitle').textContent = poem.title;
            document.getElementById('poemText').textContent = poem.text;
            document.getElementById('poemType').textContent = poem.type.charAt(0).toUpperCase() + poem.type.slice(1);
            
            // Show action buttons
            document.getElementById('favoriteBtn').style.display = 'inline-flex';
            document.getElementById('copyBtn').style.display = 'inline-flex';
            
            // Update favorite button state
            const isFavorite = favoritePoems.some(fp => fp.id === poem.id);
            const favoriteBtn = document.getElementById('favoriteBtn');
            if (isFavorite) {
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i> Unfavorite';
                favoriteBtn.style.color = '#ef4444';
            } else {
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i> Favorite';
                favoriteBtn.style.color = 'white';
            }
        }

        function toggleFavorite() {
            if (!currentPoem) return;
            
            const index = favoritePoems.findIndex(fp => fp.id === currentPoem.id);
            
            if (index > -1) {
                favoritePoems.splice(index, 1);
                document.getElementById('favoriteBtn').innerHTML = '<i class="fas fa-heart"></i> Favorite';
                document.getElementById('favoriteBtn').style.color = 'white';
            } else {
                favoritePoems.push(currentPoem);
                document.getElementById('favoriteBtn').innerHTML = '<i class="fas fa-heart"></i> Unfavorite';
                document.getElementById('favoriteBtn').style.color = '#ef4444';
            }
            
            localStorage.setItem('favoritePoems', JSON.stringify(favoritePoems));
            updateStats();
        }

        function copyPoem() {
            if (!currentPoem) return;
            
            const textToCopy = `${currentPoem.title}\n\n${currentPoem.text}`;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                const copyBtn = document.getElementById('copyBtn');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                copyBtn.style.background = '#10b981';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = '';
                }, 2000);
            });
        }

        function addToHistory(poem) {
            poemHistory.unshift(poem);
            
            // Keep only last 20 poems
            if (poemHistory.length > 20) {
                poemHistory = poemHistory.slice(0, 20);
            }
            
            localStorage.setItem('poetryHistory', JSON.stringify(poemHistory));
            renderHistory();
        }

        function renderHistory() {
            const historyGrid = document.getElementById('historyGrid');
            historyGrid.innerHTML = '';
            
            if (poemHistory.length === 0) {
                historyGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-secondary);">
                        <i class="fas fa-history" style="font-size: 3rem; margin-bottom: 20px; display: block;"></i>
                        <h3>No poems yet</h3>
                        <p>Generate your first poem to see it here!</p>
                    </div>
                `;
                return;
            }
            
            poemHistory.forEach(poem => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.onclick = () => displayPoem(poem);
                
                historyItem.innerHTML = `
                    <div class="history-title-text">${poem.title}</div>
                    <div class="history-poem">${poem.text}</div>
                    <div class="history-meta">
                        <span class="history-type">${poem.type}</span>
                        <span>${new Date(poem.timestamp).toLocaleDateString()}</span>
                    </div>
                `;
                
                historyGrid.appendChild(historyItem);
            });
        }

        function updateStats() {
            poetryStats.totalPoems = poemHistory.length;
            poetryStats.favoritePoems = favoritePoems.length;
            
            // Count unique themes
            const themes = new Set(poemHistory.map(poem => poem.theme));
            poetryStats.uniqueThemes = themes.size;
            
            // Count total lines
            const totalLines = poemHistory.reduce((sum, poem) => {
                return sum + poem.text.split('\n').length;
            }, 0);
            poetryStats.totalLines = totalLines;
            
            document.getElementById('totalPoems').textContent = poetryStats.totalPoems;
            document.getElementById('favoritePoems').textContent = poetryStats.favoritePoems;
            document.getElementById('uniqueThemes').textContent = poetryStats.uniqueThemes;
            document.getElementById('totalLines').textContent = poetryStats.totalLines;
            
            localStorage.setItem('poetryStats', JSON.stringify(poetryStats));
        }

        // Tool functions
        function findRhymes() {
            const words = ['love', 'heart', 'light', 'night', 'dream', 'stream', 'moon', 'tune', 'star', 'far'];
            const randomWord = words[Math.floor(Math.random() * words.length)];
            
            const rhymes = {
                'love': ['dove', 'above', 'glove', 'shove'],
                'heart': ['start', 'part', 'art', 'smart'],
                'light': ['bright', 'night', 'sight', 'flight'],
                'night': ['bright', 'light', 'sight', 'flight'],
                'dream': ['stream', 'seem', 'team', 'gleam'],
                'stream': ['dream', 'seem', 'team', 'gleam'],
                'moon': ['tune', 'soon', 'noon', 'boon'],
                'tune': ['moon', 'soon', 'noon', 'boon'],
                'star': ['far', 'car', 'jar', 'bar'],
                'far': ['star', 'car', 'jar', 'bar']
            };
            
            const wordRhymes = rhymes[randomWord] || ['no rhymes found'];
            alert(`Rhymes for "${randomWord}":\n\n${wordRhymes.join(', ')}`);
        }

        function countSyllables() {
            const text = prompt('Enter text to count syllables:');
            if (!text) return;
            
            // Simple syllable counting (approximate)
            const words = text.toLowerCase().split(/\s+/);
            let syllableCount = 0;
            
            words.forEach(word => {
                // Basic syllable counting rules
                if (word.length <= 3) {
                    syllableCount += 1;
                } else if (word.endsWith('e') && !word.endsWith('le')) {
                    syllableCount += Math.ceil(word.length / 3);
                } else {
                    syllableCount += Math.ceil(word.length / 3);
                }
            });
            
            alert(`Syllable count: approximately ${syllableCount}\n\nNote: This is an approximation. For precise counting, consider using a dictionary.`);
        }

        function getInspiration() {
            const prompts = [
                "Write about the first light of dawn breaking through darkness",
                "Describe a moment of unexpected joy in everyday life",
                "Capture the feeling of standing at the edge of the ocean",
                "Write about a memory that brings both happiness and sadness",
                "Describe the sound of rain on different surfaces",
                "Capture the essence of a season changing",
                "Write about finding beauty in something broken",
                "Describe a moment of complete peace and stillness",
                "Capture the feeling of being lost and then found",
                "Write about the power of small acts of kindness"
            ];
            
            const randomPrompt = prompts[Math.floor(Math.random() * prompts.length)];
            alert(`Poetry Inspiration:\n\n"${randomPrompt}"\n\nUse this prompt to spark your creativity and write something unique!`);
        }

        function showPoetryLibrary() {
            if (favoritePoems.length === 0) {
                alert('No favorite poems yet. Generate some poems and mark them as favorites!');
                return;
            }
            
            const poemList = favoritePoems.map((poem, index) => 
                `${index + 1}. "${poem.title}" (${poem.type})\n   Theme: ${poem.theme}\n   Mood: ${poem.mood}`
            ).join('\n\n');
            
            alert(`Your Favorite Poems:\n\n${poemList}`);
        }
    </script>
</body>
</html>
