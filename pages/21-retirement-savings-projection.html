<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T69M8TNFWB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T69M8TNFWB');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retirement Savings Projection - GPT Ideas Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        
        .page-header-content {
            position: relative;
            z-index: 2;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .page-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .page-category-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .page-number-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .content-section {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }
        
        .content-section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .content-section p {
            line-height: 1.8;
            margin-bottom: 16px;
            color: var(--text-secondary);
        }
        
        .retirement-tips {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .retirement-tips h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .retirement-tips ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .retirement-tips li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .calculator-input {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
        }
        
        .calculator-input h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .calculator-result {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
        }
        
        .calculator-result h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .result-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .total-amount {
            background: var(--primary-color);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-top: 20px;
        }
        
        .total-amount .label {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .total-amount .amount {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .total-amount .breakdown {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 5px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .calculator-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .yearly-breakdown {
            margin: 20px 0;
        }
        
        .breakdown-table {
            margin-top: 20px;
            overflow-x: auto;
        }
        
        .breakdown-table table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        .breakdown-table th {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .breakdown-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .breakdown-table tr:nth-child(even) {
            background: var(--bg-tertiary);
        }
        
        .breakdown-table tr:hover {
            background: rgba(99, 102, 241, 0.05);
        }
        
        .breakdown-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .table-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
            text-align: center;
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .preset-scenarios {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .scenario-card {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .scenario-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .scenario-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .scenario-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .scenario-rate {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .scenario-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .calculator-container {
                grid-template-columns: 1fr;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .back-button {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 20px;
                display: inline-flex;
            }
            
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .preset-scenarios {
                grid-template-columns: 1fr;
            }
            
            .calculator-controls {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Retirement Savings Projection</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Finance & Money</span>
                        <span class="page-number-badge">Page #21</span>
                    </div>
                </div>
            </div>
            
            <!-- Introduction -->
            <div class="content-section">
                <h2>About Retirement Planning</h2>
                <p>
                    Plan your retirement with confidence using this comprehensive projection tool. Calculate how much you'll need 
                    to save, project your retirement income, and see how different strategies affect your financial future.
                </p>
                
                <div class="retirement-tips">
                    <h3>Retirement Planning Tips</h3>
                    <ul>
                        <li><strong>Start Early:</strong> The earlier you start, the more time compound interest has to work</li>
                        <li><strong>Diversify:</strong> Spread investments across different asset classes and accounts</li>
                        <li><strong>Consider Inflation:</strong> Plan for rising costs over time</li>
                        <li><strong>Social Security:</strong> Factor in expected benefits but don't rely solely on them</li>
                        <li><strong>Healthcare Costs:</strong> Plan for potentially high medical expenses in retirement</li>
                        <li><strong>Regular Reviews:</strong> Adjust your plan as life circumstances change</li>
                    </ul>
                </div>
            </div>
            
            <!-- Retirement Calculator -->
            <div class="content-section">
                <h2>Calculate Your Retirement Needs</h2>
                <p>Enter your current financial situation and retirement goals to see a comprehensive projection.</p>
                
                <div class="calculator-container">
                    <div class="calculator-input">
                        <h3>Current Situation</h3>
                        
                        <div class="input-group">
                            <label for="currentAge">Current Age</label>
                            <input type="number" id="currentAge" placeholder="35" min="18" max="80" step="1">
                        </div>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="retirementAge">Planned Retirement Age</label>
                                <input type="number" id="retirementAge" placeholder="65" min="45" max="85" step="1">
                            </div>
                            <div class="input-group">
                                <label for="lifeExpectancy">Life Expectancy</label>
                                <input type="number" id="lifeExpectancy" placeholder="85" min="65" max="100" step="1">
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="currentSavings">Current Retirement Savings ($)</label>
                            <input type="number" id="currentSavings" placeholder="50000" min="0" step="1000">
                        </div>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="monthlyContribution">Monthly Contribution ($)</label>
                                <input type="number" id="monthlyContribution" placeholder="1000" min="0" step="100">
                            </div>
                            <div class="input-group">
                                <label for="employerMatch">Employer Match (%)</label>
                                <input type="number" id="employerMatch" placeholder="6" min="0" max="100" step="0.1">
                            </div>
                        </div>
                        
                        <h3>Investment & Income</h3>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="expectedReturn">Expected Annual Return (%)</label>
                                <input type="number" id="expectedReturn" placeholder="7.5" min="1" max="20" step="0.1">
                            </div>
                            <div class="input-group">
                                <label for="inflationRate">Expected Inflation Rate (%)</label>
                                <input type="number" id="inflationRate" placeholder="2.5" min="0" max="10" step="0.1">
                            </div>
                        </div>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="currentIncome">Current Annual Income ($)</label>
                                <input type="number" id="currentIncome" placeholder="80000" min="0" step="1000">
                            </div>
                            <div class="input-group">
                                <label for="replacementRatio">Income Replacement Ratio (%)</label>
                                <input type="number" id="replacementRatio" placeholder="80" min="50" max="100" step="5">
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="socialSecurity">Expected Social Security ($/month)</label>
                            <input type="number" id="socialSecurity" placeholder="2500" min="0" step="100">
                        </div>
                        
                        <div class="calculator-controls">
                            <button class="btn btn-primary" onclick="calculateRetirement()">
                                <i class="fas fa-calculator"></i> Calculate
                            </button>
                            <button class="btn btn-secondary" onclick="resetCalculator()">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                            <button class="btn btn-success" onclick="saveCalculation()">
                                <i class="fas fa-save"></i> Save
                            </button>
                        </div>
                    </div>
                    
                    <div class="calculator-result">
                        <h3>Results</h3>
                        
                        <div class="result-item">
                            <span class="result-label">Years to Retirement:</span>
                            <span class="result-value" id="displayYearsToRetirement">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Retirement Years:</span>
                            <span class="result-value" id="displayRetirementYears">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Required Annual Income:</span>
                            <span class="result-value" id="displayRequiredIncome">$0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Total Needed at Retirement:</span>
                            <span class="result-value" id="displayTotalNeeded">$0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Projected Savings:</span>
                            <span class="result-value" id="displayProjectedSavings">$0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Shortfall/Surplus:</span>
                            <span class="result-value" id="displayShortfall">$0</span>
                        </div>
                        
                        <div class="total-amount">
                            <div class="label">Monthly Contribution Needed</div>
                            <div class="amount" id="displayMonthlyNeeded">$0</div>
                            <div class="breakdown" id="displayBreakdown">To reach retirement goal</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Statistics -->
            <div class="content-section">
                <h2>Retirement Summary</h2>
                <p>Key metrics to understand your retirement readiness.</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-value" id="statReadiness">0%</div>
                        <div class="stat-label">Retirement Readiness</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-value" id="statSavingsRate">0%</div>
                        <div class="stat-label">Savings Rate</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-value" id="statGrowth">0%</div>
                        <div class="stat-label">Portfolio Growth</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">‚è∞</div>
                        <div class="stat-value" id="statTimeline">0</div>
                        <div class="stat-label">Years to Goal</div>
                    </div>
                </div>
            </div>
            
            <!-- Preset Scenarios -->
            <div class="content-section">
                <h2>Quick Start Scenarios</h2>
                <p>Click any scenario to quickly set realistic retirement planning parameters.</p>
        
                <div class="preset-scenarios">
                    <div class="scenario-card" onclick="setScenario('Early Starter', 25, 55, 85, 10000, 800, 6, 80000, 80, 2500)">
                        <div class="scenario-icon">üöÄ</div>
                        <div class="scenario-title">Early Starter</div>
                        <div class="scenario-rate">30 years to save</div>
                        <div class="scenario-description">Start at 25, retire at 55, aggressive timeline</div>
                    </div>
                    
                    <div class="scenario-card" onclick="setScenario('Standard Plan', 35, 65, 85, 50000, 1000, 6, 80000, 80, 2500)">
                        <div class="scenario-icon">‚öñÔ∏è</div>
                        <div class="scenario-title">Standard Plan</div>
                        <div class="scenario-rate">30 years to save</div>
                        <div class="scenario-description">Typical retirement planning, 65 retirement</div>
                    </div>
                    
                    <div class="scenario-card" onclick="setScenario('Late Bloomer', 45, 70, 85, 100000, 1500, 6, 100000, 75, 3000)">
                        <div class="scenario-icon">üå±</div>
                        <div class="scenario-title">Late Bloomer</div>
                        <div class="scenario-rate">25 years to save</div>
                        <div class="scenario-description">Start planning at 45, higher contributions</div>
                    </div>
                    
                    <div class="scenario-card" onclick="setScenario('Conservative', 40, 67, 90, 75000, 800, 5, 70000, 70, 2000)">
                        <div class="scenario-icon">üõ°Ô∏è</div>
                        <div class="scenario-title">Conservative</div>
                        <div class="scenario-rate">27 years to save</div>
                        <div class="scenario-description">Lower returns, higher safety margin</div>
                    </div>
                    
                    <div class="scenario-card" onclick="setScenario('High Earner', 30, 60, 85, 100000, 2000, 8, 150000, 85, 4000)">
                        <div class="scenario-icon">üíé</div>
                        <div class="scenario-title">High Earner</div>
                        <div class="scenario-rate">30 years to save</div>
                        <div class="scenario-description">High income, early retirement goal</div>
                    </div>
                    
                    <div class="scenario-card" onclick="setScenario('Part-Time', 50, 75, 85, 200000, 500, 4, 50000, 60, 1500)">
                        <div class="scenario-icon">üïê</div>
                        <div class="scenario-title">Part-Time</div>
                        <div class="scenario-rate">25 years to save</div>
                        <div class="scenario-description">Lower income, longer working years</div>
                    </div>
                </div>
            </div>
            
            <!-- Yearly Breakdown -->
            <div class="content-section">
                <h2>Yearly Breakdown</h2>
                <p>See how your retirement savings grow year by year and your projected retirement income.</p>
                
                <div class="yearly-breakdown">
                    <div class="breakdown-controls">
                        <div class="table-info">
                            Showing first 10 years of savings
                        </div>
                        <button class="btn btn-secondary" onclick="toggleFullBreakdown()">
                            <i class="fas fa-table"></i> Show Full Breakdown
                        </button>
                    </div>
                    
                    <div class="breakdown-table">
                        <table id="breakdownTable">
                            <thead>
                                <tr>
                                    <th>Year</th>
                                    <th>Age</th>
                                    <th>Contributions</th>
                                    <th>Investment Growth</th>
                                    <th>Total Savings</th>
                                    <th>Years to Retirement</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-muted);">
                                        <i class="fas fa-calculator" style="font-size: 2rem; margin-bottom: 15px; display: block; color: var(--border-color);"></i>
                                        Calculate retirement projection to see the yearly breakdown here.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Retirement calculator state
        let calculationHistory = JSON.parse(localStorage.getItem('retirementHistory')) || [];
        let showFullBreakdown = false;
        let currentCalculation = null;
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Set default values
            document.getElementById('currentAge').value = '35';
            document.getElementById('retirementAge').value = '65';
            document.getElementById('lifeExpectancy').value = '85';
            document.getElementById('currentSavings').value = '50000';
            document.getElementById('monthlyContribution').value = '1000';
            document.getElementById('employerMatch').value = '6';
            document.getElementById('expectedReturn').value = '7.5';
            document.getElementById('inflationRate').value = '2.5';
            document.getElementById('currentIncome').value = '80000';
            document.getElementById('replacementRatio').value = '80';
            document.getElementById('socialSecurity').value = '2500';
        });
        
        // Set scenario
        function setScenario(name, currentAge, retirementAge, lifeExpectancy, currentSavings, monthlyContribution, employerMatch, currentIncome, replacementRatio, socialSecurity) {
            document.getElementById('currentAge').value = currentAge;
            document.getElementById('retirementAge').value = retirementAge;
            document.getElementById('lifeExpectancy').value = lifeExpectancy;
            document.getElementById('currentSavings').value = currentSavings;
            document.getElementById('monthlyContribution').value = monthlyContribution;
            document.getElementById('employerMatch').value = employerMatch;
            document.getElementById('currentIncome').value = currentIncome;
            document.getElementById('replacementRatio').value = replacementRatio;
            document.getElementById('socialSecurity').value = socialSecurity;
            
            // Calculate immediately
            calculateRetirement();
            
            showMessage(`Set to ${name} scenario`);
        }
        
        // Show message
        function showMessage(message) {
            const messageEl = document.createElement('div');
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-color);
                color: white;
                padding: 15px 20px;
                border-radius: var(--border-radius);
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
            `;
            
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(messageEl);
                }, 300);
            }, 3000);
        }
        
        // Calculate retirement projection
        function calculateRetirement() {
            const currentAge = parseInt(document.getElementById('currentAge').value) || 0;
            const retirementAge = parseInt(document.getElementById('retirementAge').value) || 0;
            const lifeExpectancy = parseInt(document.getElementById('lifeExpectancy').value) || 0;
            const currentSavings = parseFloat(document.getElementById('currentSavings').value) || 0;
            const monthlyContribution = parseFloat(document.getElementById('monthlyContribution').value) || 0;
            const employerMatch = parseFloat(document.getElementById('employerMatch').value) || 0;
            const expectedReturn = parseFloat(document.getElementById('expectedReturn').value) || 0;
            const inflationRate = parseFloat(document.getElementById('inflationRate').value) || 0;
            const currentIncome = parseFloat(document.getElementById('currentIncome').value) || 0;
            const replacementRatio = parseFloat(document.getElementById('replacementRatio').value) || 0;
            const socialSecurity = parseFloat(document.getElementById('socialSecurity').value) || 0;
            
            if (currentAge <= 0 || retirementAge <= currentAge || lifeExpectancy <= retirementAge) {
                alert('Please enter valid ages.');
                return;
            }
            
            try {
                const yearsToRetirement = retirementAge - currentAge;
                const retirementYears = lifeExpectancy - retirementAge;
                
                // Calculate required annual income in retirement (adjusted for inflation)
                const requiredIncome = (currentIncome * (replacementRatio / 100)) * Math.pow(1 + inflationRate / 100, yearsToRetirement);
                
                // Calculate total needed at retirement (25x rule for 4% withdrawal rate)
                const totalNeeded = requiredIncome * 25;
                
                // Calculate projected savings at retirement
                const monthlyRate = expectedReturn / 100 / 12;
                const months = yearsToRetirement * 12;
                
                // Future value of current savings
                const futureValueOfCurrent = currentSavings * Math.pow(1 + expectedReturn / 100, yearsToRetirement);
                
                // Future value of monthly contributions (including employer match)
                const totalMonthlyContribution = monthlyContribution * (1 + employerMatch / 100);
                let futureValueOfContributions = 0;
                
                if (totalMonthlyContribution > 0) {
                    futureValueOfContributions = totalMonthlyContribution * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate);
                }
                
                const projectedSavings = futureValueOfCurrent + futureValueOfContributions;
                const shortfall = totalNeeded - projectedSavings;
                
                // Calculate monthly contribution needed to reach goal
                let monthlyNeeded = 0;
                if (shortfall > 0) {
                    monthlyNeeded = shortfall / ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate);
                }
                
                // Store calculation
                currentCalculation = {
                    currentAge,
                    retirementAge,
                    lifeExpectancy,
                    currentSavings,
                    monthlyContribution,
                    employerMatch,
                    expectedReturn,
                    inflationRate,
                    currentIncome,
                    replacementRatio,
                    socialSecurity,
                    yearsToRetirement,
                    retirementYears,
                    requiredIncome,
                    totalNeeded,
                    projectedSavings,
                    shortfall,
                    monthlyNeeded,
                    calculatedAt: new Date().toISOString()
                };
                
                // Update display
                updateDisplay();
                generateYearlyBreakdown();
                updateStats();
                
            } catch (error) {
                alert('Error calculating retirement projection. Please check your inputs.');
                console.error('Calculation error:', error);
            }
        }
        
        // Update display
        function updateDisplay() {
            if (!currentCalculation) return;
            
            document.getElementById('displayYearsToRetirement').textContent = currentCalculation.yearsToRetirement;
            document.getElementById('displayRetirementYears').textContent = currentCalculation.retirementYears;
            document.getElementById('displayRequiredIncome').textContent = `$${currentCalculation.requiredIncome.toLocaleString(undefined, {maximumFractionDigits: 0})}`;
            document.getElementById('displayTotalNeeded').textContent = `$${currentCalculation.totalNeeded.toLocaleString(undefined, {maximumFractionDigits: 0})}`;
            document.getElementById('displayProjectedSavings').textContent = `$${currentCalculation.projectedSavings.toLocaleString(undefined, {maximumFractionDigits: 0})}`;
            
            const shortfallText = currentCalculation.shortfall >= 0 ? 
                `$${currentCalculation.shortfall.toLocaleString(undefined, {maximumFractionDigits: 0})}` : 
                `+$${Math.abs(currentCalculation.shortfall).toLocaleString(undefined, {maximumFractionDigits: 0})}`;
            document.getElementById('displayShortfall').textContent = shortfallText;
            
            if (currentCalculation.shortfall > 0) {
                document.getElementById('displayMonthlyNeeded').textContent = `$${currentCalculation.monthlyNeeded.toLocaleString(undefined, {maximumFractionDigits: 0})}`;
                document.getElementById('displayBreakdown').textContent = 'To reach retirement goal';
            } else {
                document.getElementById('displayMonthlyNeeded').textContent = 'Goal Met!';
                document.getElementById('displayBreakdown').textContent = 'You\'re on track for retirement';
            }
        }
        
        // Update statistics
        function updateStats() {
            if (!currentCalculation) return;
            
            // Retirement readiness percentage
            const readiness = Math.min(100, (currentCalculation.projectedSavings / currentCalculation.totalNeeded) * 100);
            document.getElementById('statReadiness').textContent = `${readiness.toFixed(1)}%`;
            
            // Savings rate
            const savingsRate = ((currentCalculation.monthlyContribution * 12) / currentCalculation.currentIncome) * 100;
            document.getElementById('statSavingsRate').textContent = `${savingsRate.toFixed(1)}%`;
            
            // Portfolio growth
            const growth = ((currentCalculation.projectedSavings - currentCalculation.currentSavings) / currentCalculation.currentSavings) * 100;
            document.getElementById('statGrowth').textContent = `${growth.toFixed(1)}%`;
            
            // Years to goal
            document.getElementById('statTimeline').textContent = currentCalculation.yearsToRetirement;
        }
        
        // Generate yearly breakdown
        function generateYearlyBreakdown() {
            if (!currentCalculation) return;
            
            const table = document.getElementById('breakdownTable');
            const tbody = table.querySelector('tbody');
            
            tbody.innerHTML = '';
            
            const maxRows = showFullBreakdown ? currentCalculation.yearsToRetirement : Math.min(10, currentCalculation.yearsToRetirement);
            
            let runningBalance = currentCalculation.currentSavings;
            const totalMonthlyContribution = currentCalculation.monthlyContribution * (1 + currentCalculation.employerMatch / 100);
            
            for (let year = 1; year <= maxRows; year++) {
                const age = currentCalculation.currentAge + year;
                const yearsToRetirement = currentCalculation.yearsToRetirement - year;
                
                // Calculate growth for this year
                const yearGrowth = runningBalance * (currentCalculation.expectedReturn / 100);
                
                // Add contributions for the year
                const yearContributions = totalMonthlyContribution * 12;
                
                // Update running balance
                runningBalance += yearGrowth + yearContributions;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${year}</td>
                    <td>${age}</td>
                    <td>$${yearContributions.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
                    <td>$${yearGrowth.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
                    <td>$${runningBalance.toLocaleString(undefined, {maximumFractionDigits: 0})}</td>
                    <td>${yearsToRetirement}</td>
                `;
            }
            
            // Update table info
            const tableInfo = document.querySelector('.table-info');
            if (showFullBreakdown) {
                tableInfo.textContent = `Showing all ${currentCalculation.yearsToRetirement} years of savings`;
            } else {
                tableInfo.textContent = `Showing first ${Math.min(10, currentCalculation.yearsToRetirement)} years of savings`;
            }
        }
        
        // Toggle full breakdown
        function toggleFullBreakdown() {
            showFullBreakdown = !showFullBreakdown;
            const button = document.querySelector('.breakdown-controls .btn');
            
            if (showFullBreakdown) {
                button.innerHTML = '<i class="fas fa-compress"></i> Show Summary';
            } else {
                button.innerHTML = '<i class="fas fa-table"></i> Show Full Breakdown';
            }
            
            if (currentCalculation) {
                generateYearlyBreakdown();
            }
        }
        
        // Reset calculator
        function resetCalculator() {
            document.getElementById('currentAge').value = '35';
            document.getElementById('retirementAge').value = '65';
            document.getElementById('lifeExpectancy').value = '85';
            document.getElementById('currentSavings').value = '50000';
            document.getElementById('monthlyContribution').value = '1000';
            document.getElementById('employerMatch').value = '6';
            document.getElementById('expectedReturn').value = '7.5';
            document.getElementById('inflationRate').value = '2.5';
            document.getElementById('currentIncome').value = '80000';
            document.getElementById('replacementRatio').value = '80';
            document.getElementById('socialSecurity').value = '2500';
            
            // Clear display
            currentCalculation = null;
            updateDisplay();
            
            // Reset display values
            document.getElementById('displayYearsToRetirement').textContent = '0';
            document.getElementById('displayRetirementYears').textContent = '0';
            document.getElementById('displayRequiredIncome').textContent = '$0';
            document.getElementById('displayTotalNeeded').textContent = '$0';
            document.getElementById('displayProjectedSavings').textContent = '$0';
            document.getElementById('displayShortfall').textContent = '$0';
            document.getElementById('displayMonthlyNeeded').textContent = '$0';
            document.getElementById('displayBreakdown').textContent = 'To reach retirement goal';
            
            // Reset stats
            document.getElementById('statReadiness').textContent = '0%';
            document.getElementById('statSavingsRate').textContent = '0%';
            document.getElementById('statGrowth').textContent = '0%';
            document.getElementById('statTimeline').textContent = '0';
            
            // Clear breakdown table
            const tbody = document.getElementById('breakdownTable').querySelector('tbody');
            tbody.innerHTML = `
                <tr>
                    <td colspan="6" style="text-align: center; padding: 40px; color: var(--text-muted);">
                        <i class="fas fa-calculator" style="font-size: 2rem; margin-bottom: 15px; display: block; color: var(--border-color);"></i>
                        Calculate retirement projection to see the yearly breakdown here.
                    </td>
                </tr>
            `;
            
            // Reset breakdown view
            showFullBreakdown = false;
            const button = document.querySelector('.breakdown-controls .btn');
            button.innerHTML = '<i class="fas fa-table"></i> Show Full Breakdown';
            document.querySelector('.table-info').textContent = 'Showing first 10 years of savings';
        }
        
        // Save calculation
        function saveCalculation() {
            if (!currentCalculation) {
                alert('Please calculate retirement projection first.');
                return;
            }
            
            const calculation = {
                ...currentCalculation,
                id: Date.now()
            };
            
            calculationHistory.push(calculation);
            localStorage.setItem('retirementHistory', JSON.stringify(calculationHistory));
            
            alert('Calculation saved successfully!');
        }
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
