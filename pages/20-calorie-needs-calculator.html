<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T69M8TNFWB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T69M8TNFWB');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calorie Needs Calculator (TDEE) - GPT Ideas Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        
        .page-header-content {
            position: relative;
            z-index: 2;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .page-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .page-category-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .page-number-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .content-section {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }
        
        .content-section h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .content-section p {
            line-height: 1.8;
            margin-bottom: 16px;
            color: var(--text-secondary);
        }
        
        .nutrition-tips {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .nutrition-tips h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .nutrition-tips ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .nutrition-tips li {
            margin-bottom: 8px;
            line-height: 1.6;
        }
        
        .calculator-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .calculator-input {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
        }
        
        .calculator-input h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .calculator-result {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
        }
        
        .calculator-result h3 {
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .result-item:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .result-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .total-amount {
            background: var(--primary-color);
            color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            text-align: center;
            margin-top: 20px;
        }
        
        .total-amount .label {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .total-amount .amount {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .total-amount .breakdown {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 5px;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: 2px solid var(--border-color);
        }
        
        .btn-secondary:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .calculator-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--bg-tertiary);
            padding: 25px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
            text-align: center;
            transition: var(--transition);
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .stat-label {
            color: var(--text-secondary);
            font-weight: 500;
        }
        
        .macro-breakdown {
            margin: 20px 0;
        }
        
        .macro-chart {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
            margin: 20px 0;
        }
        
        .macro-bars {
            display: flex;
            gap: 10px;
            align-items: end;
            height: 200px;
            margin: 20px 0;
        }
        
        .macro-bar {
            flex: 1;
            background: var(--primary-color);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            position: relative;
            min-height: 20px;
        }
        
        .macro-bar.protein {
            background: #ef4444;
        }
        
        .macro-bar.carbs {
            background: #3b82f6;
        }
        
        .macro-bar.fat {
            background: #f59e0b;
        }
        
        .macro-label {
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
        }
        
        .macro-value {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .preset-profiles {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .profile-card {
            background: white;
            padding: 20px;
            border-radius: var(--border-radius);
            border: 2px solid var(--border-color);
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .profile-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .profile-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .profile-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
        }
        
        .profile-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        @media (max-width: 768px) {
            .calculator-container {
                grid-template-columns: 1fr;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .back-button {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 20px;
                display: inline-flex;
            }
            
            .input-row {
                grid-template-columns: 1fr;
            }
            
            .preset-profiles {
                grid-template-columns: 1fr;
            }
            
            .calculator-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .macro-bars {
                flex-direction: column;
                height: auto;
                gap: 20px;
            }
            
            .macro-bar {
                height: 60px;
            }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <!-- Page Header -->
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Calorie Needs Calculator (TDEE)</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Health & Fitness</span>
                        <span class="page-number-badge">Page #20</span>
                    </div>
                </div>
            </div>
            
            <!-- Introduction -->
            <div class="content-section">
                <h2>About TDEE and Calorie Needs</h2>
                <p>
                    Calculate your Total Daily Energy Expenditure (TDEE) to determine how many calories you need to maintain, 
                    lose, or gain weight. TDEE accounts for your basal metabolic rate and activity level.
                </p>
                
                <div class="nutrition-tips">
                    <h3>Nutrition & Calorie Tips</h3>
                    <ul>
                        <li><strong>BMR:</strong> Your body burns calories even at rest for basic functions</li>
                        <li><strong>Activity Level:</strong> More active lifestyles require more calories</li>
                        <li><strong>Weight Goals:</strong> Create a 500-calorie deficit/surplus for gradual changes</li>
                        <li><strong>Macro Balance:</strong> Protein, carbs, and fats all play important roles</li>
                        <li><strong>Consistency:</strong> Track your intake and adjust based on results</li>
                        <li><strong>Hydration:</strong> Drink plenty of water for optimal metabolism</li>
                    </ul>
                </div>
            </div>
            
            <!-- TDEE Calculator -->
            <div class="content-section">
                <h2>Calculate Your Calorie Needs</h2>
                <p>Enter your information to calculate your daily calorie requirements and macronutrient breakdown.</p>
                
                <div class="calculator-container">
                    <div class="calculator-input">
                        <h3>Personal Information</h3>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="age">Age</label>
                                <input type="number" id="age" placeholder="30" min="15" max="100" step="1">
                            </div>
                            <div class="input-group">
                                <label for="gender">Gender</label>
                                <select id="gender">
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="input-row">
                            <div class="input-group">
                                <label for="weight">Weight (lbs)</label>
                                <input type="number" id="weight" placeholder="150" min="50" max="500" step="1">
                            </div>
                            <div class="input-group">
                                <label for="height">Height (inches)</label>
                                <input type="number" id="height" placeholder="68" min="48" max="84" step="1">
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="activityLevel">Activity Level</label>
                            <select id="activityLevel">
                                <option value="1.2">Sedentary (little or no exercise)</option>
                                <option value="1.375">Lightly active (light exercise 1-3 days/week)</option>
                                <option value="1.55" selected>Moderately active (moderate exercise 3-5 days/week)</option>
                                <option value="1.725">Very active (hard exercise 6-7 days/week)</option>
                                <option value="1.9">Extremely active (very hard exercise, physical job)</option>
                            </select>
                        </div>
                        
                        <div class="input-group">
                            <label for="goal">Weight Goal</label>
                            <select id="goal">
                                <option value="maintain">Maintain Weight</option>
                                <option value="lose">Lose Weight</option>
                                <option value="gain">Gain Weight</option>
                            </select>
                        </div>
                        
                        <div class="calculator-controls">
                            <button class="btn btn-primary" onclick="calculateTDEE()">
                                <i class="fas fa-calculator"></i> Calculate
                            </button>
                            <button class="btn btn-secondary" onclick="resetCalculator()">
                                <i class="fas fa-undo"></i> Reset
                            </button>
                            <button class="btn btn-success" onclick="saveCalculation()">
                                <i class="fas fa-save"></i> Save
                            </button>
                        </div>
                    </div>
                    
                    <div class="calculator-result">
                        <h3>Results</h3>
                        
                        <div class="result-item">
                            <span class="result-label">BMR (Basal Metabolic Rate):</span>
                            <span class="result-value" id="displayBMR">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">TDEE (Maintenance):</span>
                            <span class="result-value" id="displayTDEE">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Daily Calories (Goal):</span>
                            <span class="result-value" id="displayDailyCalories">0</span>
                        </div>
                        
                        <div class="result-item">
                            <span class="result-label">Weekly Change:</span>
                            <span class="result-value" id="displayWeeklyChange">0 lbs</span>
                        </div>
                        
                        <div class="total-amount">
                            <div class="label">Daily Calorie Target</div>
                            <div class="amount" id="displayCalorieTarget">0</div>
                            <div class="breakdown" id="displayBreakdown">calories per day</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Statistics -->
            <div class="content-section">
                <h2>Calorie Summary</h2>
                <p>Key metrics to understand your energy needs.</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üî•</div>
                        <div class="stat-value" id="statBMR">0</div>
                        <div class="stat-label">BMR Calories</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">‚ö°</div>
                        <div class="stat-value" id="statActivity">0</div>
                        <div class="stat-label">Activity Calories</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üéØ</div>
                        <div class="stat-value" id="statDeficit">0</div>
                        <div class="stat-label">Daily Deficit/Surplus</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üìä</div>
                        <div class="stat-value" id="statBMI">0</div>
                        <div class="stat-label">BMI</div>
                    </div>
                </div>
            </div>
            
            <!-- Macronutrient Breakdown -->
            <div class="content-section">
                <h2>Macronutrient Breakdown</h2>
                <p>See how your daily calories should be distributed across protein, carbohydrates, and fats.</p>
                
                <div class="macro-breakdown">
                    <div class="macro-chart">
                        <div class="macro-bars" id="macroBars">
                            <div class="macro-bar protein" style="height: 0%">
                                <div class="macro-value">0g</div>
                                <div class="macro-label">Protein</div>
                            </div>
                            <div class="macro-bar carbs" style="height: 0%">
                                <div class="macro-value">0g</div>
                                <div class="macro-label">Carbs</div>
                            </div>
                            <div class="macro-bar fat" style="height: 0%">
                                <div class="macro-value">0g</div>
                                <div class="macro-label">Fat</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px;">
                            <p><strong>Recommended Daily Intake:</strong></p>
                            <p>Protein: <span id="macroProtein">0g</span> | Carbs: <span id="macroCarbs">0g</span> | Fat: <span id="macroFat">0g</span></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Preset Profiles -->
            <div class="content-section">
                <h2>Quick Start Profiles</h2>
                <p>Click any profile to quickly set common body types and goals.</p>
        
                <div class="preset-profiles">
                    <div class="profile-card" onclick="setProfile('Average Male', 30, 'male', 175, 70, 1.55, 'maintain')">
                        <div class="profile-icon">üë®</div>
                        <div class="profile-title">Average Male</div>
                        <div class="profile-description">30 years, 175 lbs, 5'10", moderate activity</div>
                    </div>
                    
                    <div class="profile-card" onclick="setProfile('Average Female', 28, 'female', 140, 65, 1.375, 'maintain')">
                        <div class="profile-icon">üë©</div>
                        <div class="profile-title">Average Female</div>
                        <div class="profile-description">28 years, 140 lbs, 5'5", light activity</div>
                    </div>
                    
                    <div class="profile-card" onclick="setProfile('Athlete', 25, 'male', 180, 72, 1.9, 'maintain')">
                        <div class="profile-icon">üèÉ</div>
                        <div class="profile-title">Athlete</div>
                        <div class="profile-description">25 years, 180 lbs, 6'0", very active</div>
                    </div>
                    
                    <div class="profile-card" onclick="setProfile('Weight Loss', 35, 'female', 160, 64, 1.375, 'lose')">
                        <div class="profile-icon">‚öñÔ∏è</div>
                        <div class="profile-title">Weight Loss</div>
                        <div class="profile-description">35 years, 160 lbs, 5'4", light activity</div>
                    </div>
                    
                    <div class="profile-card" onclick="setProfile('Muscle Gain', 22, 'male', 150, 69, 1.725, 'gain')">
                        <div class="profile-icon">üí™</div>
                        <div class="profile-title">Muscle Gain</div>
                        <div class="profile-description">22 years, 150 lbs, 5'9", very active</div>
                    </div>
                    
                    <div class="profile-card" onclick="setProfile('Senior', 65, 'female', 130, 62, 1.2, 'maintain')">
                        <div class="profile-icon">üëµ</div>
                        <div class="profile-title">Senior</div>
                        <div class="profile-description">65 years, 130 lbs, 5'2", sedentary</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // TDEE calculator state
        let calculationHistory = JSON.parse(localStorage.getItem('tdeeHistory')) || [];
        let currentCalculation = null;
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Set default values
            document.getElementById('age').value = '30';
            document.getElementById('gender').value = 'male';
            document.getElementById('weight').value = '175';
            document.getElementById('height').value = '70';
            document.getElementById('activityLevel').value = '1.55';
            document.getElementById('goal').value = 'maintain';
        });
        
        // Set profile
        function setProfile(name, age, gender, weight, height, activityLevel, goal) {
            document.getElementById('age').value = age;
            document.getElementById('gender').value = gender;
            document.getElementById('weight').value = weight;
            document.getElementById('height').value = height;
            document.getElementById('activityLevel').value = activityLevel;
            document.getElementById('goal').value = goal;
            
            // Calculate immediately
            calculateTDEE();
            
            showMessage(`Set to ${name} profile`);
        }
        
        // Show message
        function showMessage(message) {
            const messageEl = document.createElement('div');
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-color);
                color: white;
                padding: 15px 20px;
                border-radius: var(--border-radius);
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
            `;
            
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(messageEl);
                }, 300);
            }, 3000);
        }
        
        // Calculate TDEE
        function calculateTDEE() {
            const age = parseInt(document.getElementById('age').value) || 0;
            const gender = document.getElementById('gender').value;
            const weight = parseFloat(document.getElementById('weight').value) || 0;
            const height = parseFloat(document.getElementById('height').value) || 0;
            const activityLevel = parseFloat(document.getElementById('activityLevel').value) || 1.55;
            const goal = document.getElementById('goal').value;
            
            if (age <= 0 || weight <= 0 || height <= 0) {
                alert('Please enter valid values for age, weight, and height.');
                return;
            }
            
            try {
                // Calculate BMR using Mifflin-St Jeor Equation
                let bmr;
                if (gender === 'male') {
                    bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
                } else {
                    bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
                }
                
                // Calculate TDEE
                const tdee = bmr * activityLevel;
                
                // Calculate daily calories based on goal
                let dailyCalories;
                let weeklyChange;
                
                switch (goal) {
                    case 'lose':
                        dailyCalories = tdee - 500; // 500 calorie deficit for ~1 lb/week loss
                        weeklyChange = -1;
                        break;
                    case 'gain':
                        dailyCalories = tdee + 500; // 500 calorie surplus for ~1 lb/week gain
                        weeklyChange = 1;
                        break;
                    default: // maintain
                        dailyCalories = tdee;
                        weeklyChange = 0;
                        break;
                }
                
                // Calculate macronutrients
                const protein = Math.round((dailyCalories * 0.3) / 4); // 30% of calories, 4 cal/g
                const carbs = Math.round((dailyCalories * 0.45) / 4); // 45% of calories, 4 cal/g
                const fat = Math.round((dailyCalories * 0.25) / 9); // 25% of calories, 9 cal/g
                
                // Calculate BMI
                const bmi = (weight / Math.pow(height, 2)) * 703;
                
                // Store calculation
                currentCalculation = {
                    age,
                    gender,
                    weight,
                    height,
                    activityLevel,
                    goal,
                    bmr: Math.round(bmr),
                    tdee: Math.round(tdee),
                    dailyCalories: Math.round(dailyCalories),
                    weeklyChange,
                    protein,
                    carbs,
                    fat,
                    bmi: Math.round(bmi * 10) / 10,
                    calculatedAt: new Date().toISOString()
                };
                
                // Update display
                updateDisplay();
                updateStats();
                updateMacros();
                
            } catch (error) {
                alert('Error calculating TDEE. Please check your inputs.');
                console.error('Calculation error:', error);
            }
        }
        
        // Update display
        function updateDisplay() {
            if (!currentCalculation) return;
            
            document.getElementById('displayBMR').textContent = `${currentCalculation.bmr} cal`;
            document.getElementById('displayTDEE').textContent = `${currentCalculation.tdee} cal`;
            document.getElementById('displayDailyCalories').textContent = `${currentCalculation.dailyCalories} cal`;
            
            const changeText = currentCalculation.weeklyChange === 0 ? '0 lbs' : 
                `${currentCalculation.weeklyChange > 0 ? '+' : ''}${currentCalculation.weeklyChange} lbs`;
            document.getElementById('displayWeeklyChange').textContent = changeText;
            
            document.getElementById('displayCalorieTarget').textContent = currentCalculation.dailyCalories;
            
            const breakdownText = currentCalculation.goal === 'maintain' ? 'calories per day' :
                currentCalculation.goal === 'lose' ? 'calories per day (deficit)' :
                'calories per day (surplus)';
            document.getElementById('displayBreakdown').textContent = breakdownText;
        }
        
        // Update statistics
        function updateStats() {
            if (!currentCalculation) return;
            
            document.getElementById('statBMR').textContent = currentCalculation.bmr;
            document.getElementById('statActivity').textContent = currentCalculation.tdee - currentCalculation.bmr;
            document.getElementById('statDeficit').textContent = currentCalculation.tdee - currentCalculation.dailyCalories;
            document.getElementById('statBMI').textContent = currentCalculation.bmi;
        }
        
        // Update macronutrients
        function updateMacros() {
            if (!currentCalculation) return;
            
            // Update macro values
            document.getElementById('macroProtein').textContent = `${currentCalculation.protein}g`;
            document.getElementById('macroCarbs').textContent = `${currentCalculation.carbs}g`;
            document.getElementById('macroFat').textContent = `${currentCalculation.fat}g`;
            
            // Update macro bars
            const maxMacro = Math.max(currentCalculation.protein, currentCalculation.carbs, currentCalculation.fat);
            
            const proteinBar = document.querySelector('.macro-bar.protein');
            const carbsBar = document.querySelector('.macro-bar.carbs');
            const fatBar = document.querySelector('.macro-bar.fat');
            
            const proteinHeight = (currentCalculation.protein / maxMacro) * 100;
            const carbsHeight = (currentCalculation.carbs / maxMacro) * 100;
            const fatHeight = (currentCalculation.fat / maxMacro) * 100;
            
            proteinBar.style.height = `${proteinHeight}%`;
            carbsBar.style.height = `${carbsHeight}%`;
            fatBar.style.height = `${fatHeight}%`;
            
            // Update values on bars
            proteinBar.querySelector('.macro-value').textContent = `${currentCalculation.protein}g`;
            carbsBar.querySelector('.macro-value').textContent = `${currentCalculation.carbs}g`;
            fatBar.querySelector('.macro-value').textContent = `${currentCalculation.fat}g`;
        }
        
        // Reset calculator
        function resetCalculator() {
            document.getElementById('age').value = '30';
            document.getElementById('gender').value = 'male';
            document.getElementById('weight').value = '175';
            document.getElementById('height').value = '70';
            document.getElementById('activityLevel').value = '1.55';
            document.getElementById('goal').value = 'maintain';
            
            // Clear display
            currentCalculation = null;
            updateDisplay();
            
            // Reset display values
            document.getElementById('displayBMR').textContent = '0';
            document.getElementById('displayTDEE').textContent = '0';
            document.getElementById('displayDailyCalories').textContent = '0';
            document.getElementById('displayWeeklyChange').textContent = '0 lbs';
            document.getElementById('displayCalorieTarget').textContent = '0';
            document.getElementById('displayBreakdown').textContent = 'calories per day';
            
            // Reset stats
            document.getElementById('statBMR').textContent = '0';
            document.getElementById('statActivity').textContent = '0';
            document.getElementById('statDeficit').textContent = '0';
            document.getElementById('statBMI').textContent = '0';
            
            // Reset macros
            document.getElementById('macroProtein').textContent = '0g';
            document.getElementById('macroCarbs').textContent = '0g';
            document.getElementById('macroFat').textContent = '0g';
            
            // Reset macro bars
            const proteinBar = document.querySelector('.macro-bar.protein');
            const carbsBar = document.querySelector('.macro-bar.carbs');
            const fatBar = document.querySelector('.macro-bar.fat');
            
            proteinBar.style.height = '0%';
            carbsBar.style.height = '0%';
            fatBar.style.height = '0%';
            
            proteinBar.querySelector('.macro-value').textContent = '0g';
            carbsBar.querySelector('.macro-value').textContent = '0g';
            fatBar.querySelector('.macro-value').textContent = '0g';
        }
        
        // Save calculation
        function saveCalculation() {
            if (!currentCalculation) {
                alert('Please calculate TDEE first.');
                return;
            }
            
            const calculation = {
                ...currentCalculation,
                id: Date.now()
            };
            
            calculationHistory.push(calculation);
            localStorage.setItem('tdeeHistory', JSON.stringify(calculationHistory));
            
            alert('Calculation saved successfully!');
        }
        
        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
