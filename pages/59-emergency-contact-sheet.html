<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergency Contact Sheet - GPT Static Pages</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 0;
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--border-radius);
            position: relative;
            overflow: hidden;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
        }
        
        .page-header-content {
            position: relative;
            z-index: 2;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Space Grotesk', sans-serif;
        }
        
        .page-meta {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .page-category-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .page-number-badge {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-color);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .content-section {
            background: white;
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow-md);
        }
        
        .emergency-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .contact-setup {
            text-align: center;
        }
        
        .setup-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .form-group {
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .add-contact-btn {
            padding: 15px 30px;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            background: var(--primary-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
        }
        
        .add-contact-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .emergency-contacts {
            text-align: center;
        }
        
        .contacts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .contact-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            text-align: left;
            position: relative;
        }
        
        .contact-card.emergency {
            border-color: var(--danger-color);
            background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
        }
        
        .contact-card.medical {
            border-color: var(--success-color);
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
        }
        
        .contact-card.consulate {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        }
        
        .contact-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .contact-type {
            font-size: 0.8rem;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 15px;
            text-transform: uppercase;
        }
        
        .contact-type.emergency {
            background: var(--danger-color);
            color: white;
        }
        
        .contact-type.medical {
            background: var(--success-color);
            color: white;
        }
        
        .contact-type.consulate {
            background: var(--primary-color);
            color: white;
        }
        
        .contact-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        
        .edit-btn {
            background: var(--primary-color);
            color: white;
        }
        
        .edit-btn:hover {
            background: var(--primary-dark);
        }
        
        .delete-btn {
            background: var(--danger-color);
            color: white;
        }
        
        .delete-btn:hover {
            background: #d32f2f;
        }
        
        .contact-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .contact-phone {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .contact-email {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }
        
        .contact-notes {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-style: italic;
            line-height: 1.4;
        }
        
        .emergency-info {
            text-align: center;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .info-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            text-align: center;
        }
        
        .info-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .info-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .info-content {
            color: var(--text-secondary);
            line-height: 1.5;
        }
        
        .emergency-templates {
            text-align: center;
        }
        
        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .template-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .template-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .template-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .template-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        
        .template-contacts {
            font-size: 0.8rem;
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .emergency-actions {
            text-align: center;
        }
        
        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .action-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .action-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .action-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .action-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .action-description {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        .emergency-stats {
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .emergency-history {
            text-align: center;
        }
        
        .history-list {
            max-height: 300px;
            overflow-y: auto;
            margin: 20px 0;
        }
        
        .history-item {
            background: var(--light-bg);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            text-align: left;
            border-left: 4px solid var(--primary-color);
        }
        
        .history-action {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }
        
        .history-date {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .history-details {
            font-size: 0.8rem;
            color: var(--primary-color);
            margin-top: 5px;
        }
        
        .clear-history-btn {
            padding: 10px 20px;
            border: 2px solid var(--danger-color);
            border-radius: 8px;
            background: transparent;
            color: var(--danger-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .clear-history-btn:hover {
            background: var(--danger-color);
            color: white;
        }
        
        .print-btn {
            padding: 15px 30px;
            border: 2px solid var(--success-color);
            border-radius: 10px;
            background: var(--success-color);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto;
        }
        
        .print-btn:hover {
            background: #388e3c;
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .setup-form {
                grid-template-columns: 1fr;
            }
            
            .contacts-grid {
                grid-template-columns: 1fr;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .template-grid {
                grid-template-columns: 1fr;
            }
            
            .action-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media print {
            .back-button, .add-contact-btn, .print-btn, .action-btn {
                display: none !important;
            }
            
            .page-content {
                padding: 20px;
            }
            
            .content-section {
                box-shadow: none;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i>
        Back to Hub
    </a>

    <div class="page-content">
        <div class="page-header">
            <div class="page-header-content">
                <h1 class="page-title">Emergency Contact Sheet</h1>
                <div class="page-meta">
                    <span class="page-category-badge">Travel & Navigation</span>
                    <span class="page-number-badge">Page 59</span>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-container">
                <div class="contact-setup">
                    <h2 class="setup-title">Add Emergency Contact</h2>
                    <div class="setup-form">
                        <div class="form-group">
                            <label for="contactName">Contact Name</label>
                            <input type="text" id="contactName" placeholder="Enter full name">
                        </div>
                        <div class="form-group">
                            <label for="contactType">Contact Type</label>
                            <select id="contactType">
                                <option value="emergency">Emergency Contact</option>
                                <option value="medical">Medical Contact</option>
                                <option value="consulate">Consulate/Embassy</option>
                                <option value="hotel">Hotel Contact</option>
                                <option value="transport">Transportation</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="contactPhone">Phone Number</label>
                            <input type="tel" id="contactPhone" placeholder="Enter phone number">
                        </div>
                        <div class="form-group">
                            <label for="contactEmail">Email (Optional)</label>
                            <input type="email" id="contactEmail" placeholder="Enter email address">
                        </div>
                        <div class="form-group">
                            <label for="contactNotes">Notes (Optional)</label>
                            <textarea id="contactNotes" placeholder="Add any additional information"></textarea>
                        </div>
                        <div class="form-group">
                            <button class="add-contact-btn" onclick="addContact()">
                                <i class="fas fa-plus"></i>
                                Add Contact
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-contacts">
                <h3>Your Emergency Contacts</h3>
                <div class="contacts-grid" id="contactsGrid">
                    <!-- Contacts will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-info">
                <h3>Essential Emergency Information</h3>
                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-icon">üö®</div>
                        <div class="info-title">Universal Emergency Number</div>
                        <div class="info-content">112 (EU) / 911 (US) / 999 (UK) / 110 (Japan)</div>
                    </div>
                    <div class="info-card">
                        <div class="info-icon">üè•</div>
                        <div class="info-title">Medical Emergencies</div>
                        <div class="info-content">Always call local emergency services first, then your medical contact</div>
                    </div>
                    <div class="info-card">
                        <div class="info-icon">üëÆ</div>
                        <div class="info-title">Police Contact</div>
                        <div class="info-content">Local police: 110 (Japan) / 999 (UK) / 911 (US)</div>
                    </div>
                    <div class="info-card">
                        <div class="info-icon">üåç</div>
                        <div class="info-title">Consulate Services</div>
                        <div class="info-content">Your country's embassy for passport issues and legal help</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-templates">
                <h3>Quick Templates</h3>
                <div class="template-grid" id="templateGrid">
                    <!-- Templates will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-actions">
                <h3>Emergency Actions</h3>
                <div class="action-grid">
                    <div class="action-card">
                        <div class="action-icon">üì±</div>
                        <div class="action-title">Call Emergency Services</div>
                        <div class="action-description">Dial the local emergency number immediately for life-threatening situations</div>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">üè•</div>
                        <div class="action-title">Seek Medical Help</div>
                        <div class="action-description">Contact your medical contact or visit the nearest hospital</div>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">üëÆ</div>
                        <div class="action-title">Report to Police</div>
                        <div class="action-description">File a police report for theft, assault, or other crimes</div>
                    </div>
                    <div class="action-card">
                        <div class="action-icon">üåç</div>
                        <div class="action-title">Contact Consulate</div>
                        <div class="action-description">Reach out to your country's embassy for assistance</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-stats">
                <h3>Your Emergency Contact Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalContacts">0</div>
                        <div class="stat-label">Total Contacts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="emergencyContacts">0</div>
                        <div class="stat-label">Emergency Contacts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="medicalContacts">0</div>
                        <div class="stat-label">Medical Contacts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="consulateContacts">0</div>
                        <div class="stat-label">Consulate Contacts</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="content-section">
            <div class="emergency-history">
                <h3>Contact Management History</h3>
                <div class="history-list" id="historyList">
                    <!-- History will be populated by JavaScript -->
                </div>
                <button class="clear-history-btn" onclick="clearHistory()">
                    <i class="fas fa-trash"></i>
                    Clear History
                </button>
            </div>
        </div>

        <button class="print-btn" onclick="printContactSheet()">
            <i class="fas fa-print"></i>
            Print Contact Sheet
        </button>
    </div>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadTemplates();
            loadSavedData();
            updateStats();
        });

        function addContact() {
            const name = document.getElementById('contactName').value.trim();
            const type = document.getElementById('contactType').value;
            const phone = document.getElementById('contactPhone').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const notes = document.getElementById('contactNotes').value.trim();

            if (!name || !phone) {
                alert('Please fill in at least the name and phone number');
                return;
            }

            const contact = {
                id: Date.now(),
                name,
                type,
                phone,
                email,
                notes,
                timestamp: new Date().toISOString()
            };

            // Save contact
            saveContact(contact);
            
            // Clear form
            clearForm();
            
            // Update display
            displayContacts();
            
            // Save to history
            saveToHistory('Added', contact);
            
            // Update stats
            updateStats();
        }

        function saveContact(contact) {
            const contacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
            contacts.push(contact);
            localStorage.setItem('emergencyContacts', JSON.stringify(contacts));
        }

        function clearForm() {
            document.getElementById('contactName').value = '';
            document.getElementById('contactType').value = 'emergency';
            document.getElementById('contactPhone').value = '';
            document.getElementById('contactEmail').value = '';
            document.getElementById('contactNotes').value = '';
        }

        function displayContacts() {
            const contacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
            const grid = document.getElementById('contactsGrid');
            
            grid.innerHTML = '';
            
            if (contacts.length === 0) {
                grid.innerHTML = '<p>No contacts added yet. Add your first emergency contact above.</p>';
                return;
            }
            
            contacts.forEach(contact => {
                const card = document.createElement('div');
                card.className = `contact-card ${contact.type}`;
                
                card.innerHTML = `
                    <div class="contact-header">
                        <span class="contact-type ${contact.type}">${contact.type}</span>
                        <div class="contact-actions">
                            <button class="action-btn edit-btn" onclick="editContact(${contact.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteContact(${contact.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="contact-name">${contact.name}</div>
                    <div class="contact-phone">üìû ${contact.phone}</div>
                    ${contact.email ? `<div class="contact-email">üìß ${contact.email}</div>` : ''}
                    ${contact.notes ? `<div class="contact-notes">üìù ${contact.notes}</div>` : ''}
                `;
                
                grid.appendChild(card);
            });
        }

        function editContact(id) {
            const contacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
            const contact = contacts.find(c => c.id === id);
            
            if (!contact) return;
            
            // Populate form for editing
            document.getElementById('contactName').value = contact.name;
            document.getElementById('contactType').value = contact.type;
            document.getElementById('contactPhone').value = contact.phone;
            document.getElementById('contactEmail').value = contact.email;
            document.getElementById('contactNotes').value = contact.notes;
            
            // Remove old contact and update button
            deleteContact(id, false);
            
            // Change button text
            const btn = document.querySelector('.add-contact-btn');
            btn.innerHTML = '<i class="fas fa-save"></i> Update Contact';
            btn.onclick = () => updateContact(id);
        }

        function updateContact(id) {
            const name = document.getElementById('contactName').value.trim();
            const type = document.getElementById('contactType').value;
            const phone = document.getElementById('contactPhone').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const notes = document.getElementById('contactNotes').value.trim();

            if (!name || !phone) {
                alert('Please fill in at least the name and phone number');
                return;
            }

            const contact = {
                id,
                name,
                type,
                phone,
                email,
                notes,
                timestamp: new Date().toISOString()
            };

            // Save contact
            saveContact(contact);
            
            // Clear form and reset button
            clearForm();
            const btn = document.querySelector('.add-contact-btn');
            btn.innerHTML = '<i class="fas fa-plus"></i> Add Contact';
            btn.onclick = addContact;
            
            // Update display
            displayContacts();
            
            // Save to history
            saveToHistory('Updated', contact);
            
            // Update stats
            updateStats();
        }

        function deleteContact(id, saveHistory = true) {
            if (saveHistory && !confirm('Are you sure you want to delete this contact?')) {
                return;
            }

            const contacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
            const contactToDelete = contacts.find(c => c.id === id);
            const filteredContacts = contacts.filter(c => c.id !== id);
            
            localStorage.setItem('emergencyContacts', JSON.stringify(filteredContacts));
            
            if (saveHistory && contactToDelete) {
                saveToHistory('Deleted', contactToDelete);
            }
            
            displayContacts();
            updateStats();
        }

        function loadTemplates() {
            const templates = [
                { title: 'Basic Emergency Kit', description: 'Essential emergency contacts for any trip', contacts: 'Emergency, Medical, Consulate' },
                { title: 'Business Travel', description: 'Emergency contacts for business travelers', contacts: 'Emergency, Hotel, Transport, Consulate' },
                { title: 'Family Vacation', description: 'Family-friendly emergency contact setup', contacts: 'Emergency, Medical, Hotel, Transport' },
                { title: 'Solo Adventure', description: 'Comprehensive contacts for solo travelers', contacts: 'Emergency, Medical, Consulate, Transport' }
            ];
            
            const templateGrid = document.getElementById('templateGrid');
            templateGrid.innerHTML = '';
            
            templates.forEach(template => {
                const templateCard = document.createElement('div');
                templateCard.className = 'template-card';
                templateCard.onclick = () => loadTemplate(template);
                
                templateCard.innerHTML = `
                    <div class="template-title">${template.title}</div>
                    <div class="template-description">${template.description}</div>
                    <div class="template-contacts">${template.contacts}</div>
                `;
                
                templateGrid.appendChild(templateCard);
            });
        }

        function loadTemplate(template) {
            // Load sample contacts based on template
            const sampleContacts = {
                'Basic Emergency Kit': [
                    { name: 'Local Emergency Services', type: 'emergency', phone: '112', email: '', notes: 'Universal emergency number' },
                    { name: 'Nearest Hospital', type: 'medical', phone: 'Local number', email: '', notes: 'Find nearest hospital to your location' },
                    { name: 'Your Country Embassy', type: 'consulate', phone: 'Local number', email: '', notes: 'Contact your country\'s embassy' }
                ],
                'Business Travel': [
                    { name: 'Hotel Front Desk', type: 'hotel', phone: 'Hotel number', email: '', notes: '24/7 hotel assistance' },
                    { name: 'Local Taxi Service', type: 'transport', phone: 'Local number', email: '', notes: 'Reliable taxi company' }
                ]
            };
            
            const contacts = sampleContacts[template.title] || [];
            contacts.forEach(contact => {
                contact.id = Date.now() + Math.random();
                contact.timestamp = new Date().toISOString();
                saveContact(contact);
            });
            
            displayContacts();
            updateStats();
        }

        function saveToHistory(action, contact) {
            const history = JSON.parse(localStorage.getItem('emergencyHistory') || '[]');
            const historyItem = {
                action,
                contactName: contact.name,
                contactType: contact.type,
                timestamp: new Date().toISOString()
            };
            
            // Add to beginning of array
            history.unshift(historyItem);
            
            // Keep only last 20 items
            if (history.length > 20) {
                history.pop();
            }
            
            localStorage.setItem('emergencyHistory', JSON.stringify(history));
            loadHistory();
        }

        function loadHistory() {
            const history = JSON.parse(localStorage.getItem('emergencyHistory') || '[]');
            const historyList = document.getElementById('historyList');
            
            historyList.innerHTML = '';
            
            if (history.length === 0) {
                historyList.innerHTML = '<p>No history yet</p>';
                return;
            }
            
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                historyItem.innerHTML = `
                    <div class="history-action">${item.action} ${item.contactName}</div>
                    <div class="history-date">${new Date(item.timestamp).toLocaleDateString()}</div>
                    <div class="history-details">Type: ${item.contactType}</div>
                `;
                
                historyList.appendChild(historyItem);
            });
        }

        function clearHistory() {
            if (confirm('Are you sure you want to clear all history?')) {
                localStorage.removeItem('emergencyHistory');
                loadHistory();
            }
        }

        function updateStats() {
            const contacts = JSON.parse(localStorage.getItem('emergencyContacts') || '[]');
            const totalContacts = contacts.length;
            
            const emergencyContacts = contacts.filter(c => c.type === 'emergency').length;
            const medicalContacts = contacts.filter(c => c.type === 'medical').length;
            const consulateContacts = contacts.filter(c => c.type === 'consulate').length;
            
            document.getElementById('totalContacts').textContent = totalContacts;
            document.getElementById('emergencyContacts').textContent = emergencyContacts;
            document.getElementById('medicalContacts').textContent = medicalContacts;
            document.getElementById('consulateContacts').textContent = consulateContacts;
        }

        function printContactSheet() {
            window.print();
        }

        function loadSavedData() {
            displayContacts();
            loadHistory();
        }
    </script>
</body>
</html>
