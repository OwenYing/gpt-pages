<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T69M8TNFWB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T69M8TNFWB');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Meal Planner - GPT Ideas Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }
        .page-header { text-align: center; margin-bottom: 40px; padding: 40px 0; background: var(--gradient-primary); color: white; border-radius: var(--border-radius); position: relative; overflow: hidden; }
        .page-header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>'); opacity: 0.3; }
        .page-header-content { position: relative; z-index: 2; }
        .page-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 16px; font-family: 'Space Grotesk', sans-serif; }
        .page-meta { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .page-category-badge, .page-number-badge { padding: 8px 16px; background: rgba(255, 255, 255, 0.2); border-radius: 20px; font-size: 0.9rem; font-weight: 500; }
        .back-button { position: fixed; top: 20px; left: 20px; background: var(--primary-color); color: white; padding: 12px 20px; border-radius: var(--border-radius); text-decoration: none; font-weight: 500; transition: var(--transition); z-index: 1000; display: flex; align-items: center; gap: 8px; }
        .back-button:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        
        .meal-planner-container { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .planner-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        .recipe-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        
        .week-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-bottom: 20px; }
        .day-column { text-align: center; }
        .day-header { background: var(--primary-color); color: white; padding: 10px; border-radius: var(--border-radius) var(--border-radius) 0 0; font-weight: 600; font-size: 0.9rem; }
        .day-content { background: var(--bg-secondary); padding: 15px; border-radius: 0 0 var(--border-radius) var(--border-radius); min-height: 120px; border: 2px solid transparent; }
        .day-content:hover { border-color: var(--primary-color); }
        .day-content.dragover { border-color: var(--primary-color); background: rgba(99, 102, 241, 0.1); }
        
        .meal-slot { background: white; padding: 8px; margin: 5px 0; border-radius: var(--border-radius); border: 1px solid var(--border-color); cursor: pointer; transition: var(--transition); font-size: 0.8rem; }
        .meal-slot:hover { background: var(--bg-tertiary); transform: translateY(-1px); box-shadow: var(--shadow-sm); }
        .meal-slot.breakfast { border-left: 4px solid #10b981; }
        .meal-slot.lunch { border-left: 4px solid #f59e0b; }
        .meal-slot.dinner { border-left: 4px solid #ef4444; }
        .meal-slot.snack { border-left: 4px solid #8b5cf6; }
        
        .recipe-library { max-height: 500px; overflow-y: auto; }
        .recipe-card { background: var(--bg-secondary); padding: 15px; border-radius: var(--border-radius); border: 1px solid var(--border-color); margin-bottom: 15px; cursor: move; transition: var(--transition); }
        .recipe-card:hover { background: var(--bg-tertiary); transform: translateY(-2px); box-shadow: var(--shadow-md); }
        .recipe-card.dragging { opacity: 0.5; }
        .recipe-title { font-weight: 600; color: var(--text-primary); margin-bottom: 8px; }
        .recipe-meta { display: flex; gap: 15px; font-size: 0.8rem; color: var(--text-secondary); }
        .recipe-tags { display: flex; gap: 5px; flex-wrap: wrap; }
        .recipe-tag { background: var(--primary-color); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; }
        
        .form-section { margin-bottom: 30px; }
        .form-section h3 { color: var(--primary-color); margin-bottom: 15px; border-bottom: 2px solid var(--border-color); padding-bottom: 8px; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: 500; margin-bottom: 8px; color: var(--text-primary); }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; transition: var(--transition); }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        .form-textarea { resize: vertical; min-height: 100px; }
        
        .meal-type-selector { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .meal-type-btn { padding: 8px 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); font-size: 0.9rem; }
        .meal-type-btn:hover { background: var(--bg-tertiary); }
        .meal-type-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        .grocery-list { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-top: 20px; }
        .grocery-category { margin-bottom: 20px; }
        .grocery-category h4 { color: var(--primary-color); margin-bottom: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }
        .grocery-item { display: flex; align-items: center; gap: 10px; padding: 8px; background: white; border-radius: var(--border-radius); margin-bottom: 5px; }
        .grocery-checkbox { width: 18px; height: 18px; }
        .grocery-item.completed { opacity: 0.6; text-decoration: line-through; }
        
        .action-buttons { display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; }
        .btn-primary { background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); border: 2px solid var(--border-color); padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-secondary:hover { background: var(--bg-tertiary); border-color: var(--primary-color); }
        
        .nutrition-summary { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-top: 20px; }
        .nutrition-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 15px; }
        .nutrition-item { text-align: center; }
        .nutrition-value { font-size: 1.5rem; font-weight: 600; color: var(--primary-color); }
        .nutrition-label { font-size: 0.8rem; color: var(--text-secondary); text-transform: uppercase; }
        
        .search-box { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; margin-bottom: 20px; }
        .search-box:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        
        .recipe-categories { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .category-btn { padding: 8px 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); font-size: 0.9rem; }
        .category-btn:hover { background: var(--bg-tertiary); }
        .category-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        @media (max-width: 768px) {
            .page-title { font-size: 2rem; }
            .meal-planner-container { grid-template-columns: 1fr; }
            .back-button { position: relative; top: auto; left: auto; margin-bottom: 20px; display: inline-block; }
            .week-grid { grid-template-columns: repeat(4, 1fr); }
            .week-grid .day-column:nth-child(n+5) { grid-column: span 2; }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Weekly Meal Planner</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Home & Lifestyle</span>
                        <span class="page-number-badge">Page #71</span>
                    </div>
                </div>
            </div>
            
            <div class="meal-planner-container">
                <div class="planner-panel">
                    <div class="form-section">
                        <h3>Weekly Meal Plan</h3>
                        
                        <div class="week-grid" id="weekGrid">
                            <div class="day-column">
                                <div class="day-header">Monday</div>
                                <div class="day-content" data-day="monday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="monday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="monday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="monday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="monday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Tuesday</div>
                                <div class="day-content" data-day="tuesday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="tuesday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="tuesday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="tuesday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="tuesday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Wednesday</div>
                                <div class="day-content" data-day="wednesday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="wednesday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="wednesday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="wednesday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="wednesday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Thursday</div>
                                <div class="day-content" data-day="thursday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="thursday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="thursday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="thursday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="thursday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Friday</div>
                                <div class="day-content" data-day="friday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="friday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="friday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="friday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="friday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Saturday</div>
                                <div class="day-content" data-day="saturday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="saturday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="saturday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="saturday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="saturday">Snack</div>
                                </div>
                            </div>
                            <div class="day-column">
                                <div class="day-header">Sunday</div>
                                <div class="day-content" data-day="sunday">
                                    <div class="meal-slot breakfast" data-meal="breakfast" data-day="sunday">Breakfast</div>
                                    <div class="meal-slot lunch" data-meal="lunch" data-day="sunday">Lunch</div>
                                    <div class="meal-slot dinner" data-meal="dinner" data-day="sunday">Dinner</div>
                                    <div class="meal-slot snack" data-meal="snack" data-day="sunday">Snack</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-primary" onclick="generateGroceryList()">
                                <i class="fas fa-shopping-cart"></i> Generate Grocery List
                            </button>
                            <button class="btn-secondary" onclick="clearMealPlan()">
                                <i class="fas fa-trash"></i> Clear Plan
                            </button>
                            <button class="btn-secondary" onclick="saveMealPlan()">
                                <i class="fas fa-save"></i> Save Plan
                            </button>
                        </div>
                    </div>
                    
                    <div class="grocery-list" id="groceryList" style="display: none;">
                        <h4>Shopping List</h4>
                        <div id="groceryItems"></div>
                    </div>
                    
                    <div class="nutrition-summary" id="nutritionSummary" style="display: none;">
                        <h4>Weekly Nutrition Summary</h4>
                        <div class="nutrition-grid">
                            <div class="nutrition-item">
                                <div class="nutrition-value" id="totalCalories">0</div>
                                <div class="nutrition-label">Calories</div>
                            </div>
                            <div class="nutrition-item">
                                <div class="nutrition-value" id="totalProtein">0g</div>
                                <div class="nutrition-label">Protein</div>
                            </div>
                            <div class="nutrition-item">
                                <div class="nutrition-value" id="totalCarbs">0g</div>
                                <div class="nutrition-label">Carbs</div>
                            </div>
                            <div class="nutrition-item">
                                <div class="nutrition-value" id="totalFat">0g</div>
                                <div class="nutrition-label">Fat</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="recipe-panel">
                    <div class="form-section">
                        <h3>Recipe Library</h3>
                        
                        <input type="text" class="search-box" id="searchBox" placeholder="Search recipes...">
                        
                        <div class="recipe-categories">
                            <button class="category-btn active" data-category="all">All</button>
                            <button class="category-btn" data-category="breakfast">Breakfast</button>
                            <button class="category-btn" data-category="lunch">Lunch</button>
                            <button class="category-btn" data-category="dinner">Dinner</button>
                            <button class="category-btn" data-category="snack">Snack</button>
                            <button class="category-btn" data-category="vegetarian">Vegetarian</button>
                            <button class="category-btn" data-category="quick">Quick</button>
                        </div>
                        
                        <div class="recipe-library" id="recipeLibrary">
                            <!-- Recipe cards will be populated here -->
                        </div>
                        
                        <button class="btn-primary" onclick="addNewRecipe()">
                            <i class="fas fa-plus"></i> Add New Recipe
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Sample recipe data
        const recipes = [
            {
                id: 1,
                title: "Oatmeal with Berries",
                category: "breakfast",
                tags: ["vegetarian", "quick"],
                calories: 250,
                protein: 8,
                carbs: 45,
                fat: 5,
                ingredients: ["oats", "berries", "honey", "almonds"]
            },
            {
                id: 2,
                title: "Grilled Chicken Salad",
                category: "lunch",
                tags: ["protein", "healthy"],
                calories: 350,
                protein: 35,
                carbs: 15,
                fat: 12,
                ingredients: ["chicken breast", "lettuce", "tomatoes", "olive oil"]
            },
            {
                id: 3,
                title: "Salmon with Vegetables",
                category: "dinner",
                tags: ["omega-3", "healthy"],
                calories: 450,
                protein: 40,
                carbs: 20,
                fat: 25,
                ingredients: ["salmon", "broccoli", "carrots", "lemon"]
            },
            {
                id: 4,
                title: "Greek Yogurt Parfait",
                category: "snack",
                tags: ["vegetarian", "protein"],
                calories: 200,
                protein: 15,
                carbs: 25,
                fat: 8,
                ingredients: ["greek yogurt", "granola", "honey", "berries"]
            },
            {
                id: 5,
                title: "Quinoa Bowl",
                category: "lunch",
                tags: ["vegetarian", "protein"],
                calories: 400,
                protein: 12,
                carbs: 65,
                fat: 10,
                ingredients: ["quinoa", "black beans", "corn", "avocado"]
            }
        ];
        
        let mealPlan = {};
        let draggedRecipe = null;
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadRecipes();
            setupDragAndDrop();
            loadMealPlan();
        });
        
        function loadRecipes() {
            const recipeLibrary = document.getElementById('recipeLibrary');
            recipeLibrary.innerHTML = '';
            
            recipes.forEach(recipe => {
                const recipeCard = createRecipeCard(recipe);
                recipeLibrary.appendChild(recipeCard);
            });
        }
        
        function createRecipeCard(recipe) {
            const card = document.createElement('div');
            card.className = 'recipe-card';
            card.draggable = true;
            card.dataset.recipeId = recipe.id;
            
            card.innerHTML = `
                <div class="recipe-title">${recipe.title}</div>
                <div class="recipe-meta">
                    <span>${recipe.calories} cal</span>
                    <span>${recipe.protein}g protein</span>
                </div>
                <div class="recipe-tags">
                    ${recipe.tags.map(tag => `<span class="recipe-tag">${tag}</span>`).join('')}
                </div>
            `;
            
            card.addEventListener('dragstart', handleDragStart);
            card.addEventListener('dragend', handleDragEnd);
            
            return card;
        }
        
        function setupDragAndDrop() {
            const mealSlots = document.querySelectorAll('.meal-slot');
            const dayContents = document.querySelectorAll('.day-content');
            
            mealSlots.forEach(slot => {
                slot.addEventListener('dragover', handleDragOver);
                slot.addEventListener('drop', handleDrop);
                slot.addEventListener('dragenter', handleDragEnter);
                slot.addEventListener('dragleave', handleDragLeave);
            });
            
            dayContents.forEach(content => {
                content.addEventListener('dragover', handleDragOver);
                content.addEventListener('drop', handleDrop);
                content.addEventListener('dragenter', handleDragEnter);
                content.addEventListener('dragleave', handleDragLeave);
            });
        }
        
        function handleDragStart(e) {
            draggedRecipe = e.target;
            e.target.classList.add('dragging');
        }
        
        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }
        
        function handleDragOver(e) {
            e.preventDefault();
        }
        
        function handleDragEnter(e) {
            e.preventDefault();
            e.target.classList.add('dragover');
        }
        
        function handleDragLeave(e) {
            e.target.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('dragover');
            
            if (draggedRecipe && draggedRecipe.classList.contains('recipe-card')) {
                const recipeId = parseInt(draggedRecipe.dataset.recipeId);
                const recipe = recipes.find(r => r.id === recipeId);
                
                if (e.target.classList.contains('meal-slot')) {
                    // Drop on meal slot
                    const day = e.target.dataset.day;
                    const meal = e.target.dataset.meal;
                    
                    if (!mealPlan[day]) mealPlan[day] = {};
                    mealPlan[day][meal] = recipe;
                    
                    e.target.innerHTML = `
                        <div style="font-weight: 600; color: var(--primary-color);">${recipe.title}</div>
                        <div style="font-size: 0.7rem; color: var(--text-secondary);">${recipe.calories} cal</div>
                    `;
                    e.target.style.background = 'rgba(99, 102, 241, 0.1)';
                    e.target.style.border = '2px solid var(--primary-color)';
                } else if (e.target.classList.contains('day-content')) {
                    // Drop on day content area
                    const day = e.target.dataset.day;
                    const mealType = prompt('Which meal type? (breakfast/lunch/dinner/snack):');
                    
                    if (mealType && ['breakfast', 'lunch', 'dinner', 'snack'].includes(mealType.toLowerCase())) {
                        if (!mealPlan[day]) mealPlan[day] = {};
                        mealPlan[day][mealType.toLowerCase()] = recipe;
                        
                        const mealSlot = e.target.querySelector(`[data-meal="${mealType.toLowerCase()}"]`);
                        if (mealSlot) {
                            mealSlot.innerHTML = `
                                <div style="font-weight: 600; color: var(--primary-color);">${recipe.title}</div>
                                <div style="font-size: 0.7rem; color: var(--text-secondary);">${recipe.calories} cal</div>
                            `;
                            mealSlot.style.background = 'rgba(99, 102, 241, 0.1)';
                            mealSlot.style.border = '2px solid var(--primary-color)';
                        }
                    }
                }
                
                saveMealPlan();
                updateNutritionSummary();
            }
        }
        
        function generateGroceryList() {
            const groceryList = document.getElementById('groceryList');
            const groceryItems = document.getElementById('groceryItems');
            
            if (Object.keys(mealPlan).length === 0) {
                alert('Please add some meals to your plan first!');
                return;
            }
            
            const ingredients = new Set();
            
            Object.values(mealPlan).forEach(dayMeals => {
                Object.values(dayMeals).forEach(recipe => {
                    if (recipe && recipe.ingredients) {
                        recipe.ingredients.forEach(ingredient => {
                            ingredients.add(ingredient);
                        });
                    }
                });
            });
            
            groceryItems.innerHTML = '';
            Array.from(ingredients).sort().forEach(ingredient => {
                const item = document.createElement('div');
                item.className = 'grocery-item';
                item.innerHTML = `
                    <input type="checkbox" class="grocery-checkbox">
                    <span>${ingredient}</span>
                `;
                groceryItems.appendChild(item);
                
                item.querySelector('.grocery-checkbox').addEventListener('change', function() {
                    if (this.checked) {
                        item.classList.add('completed');
                    } else {
                        item.classList.remove('completed');
                    }
                });
            });
            
            groceryList.style.display = 'block';
        }
        
        function updateNutritionSummary() {
            const nutritionSummary = document.getElementById('nutritionSummary');
            let totalCalories = 0, totalProtein = 0, totalCarbs = 0, totalFat = 0;
            
            Object.values(mealPlan).forEach(dayMeals => {
                Object.values(dayMeals).forEach(recipe => {
                    if (recipe) {
                        totalCalories += recipe.calories;
                        totalProtein += recipe.protein;
                        totalCarbs += recipe.carbs;
                        totalFat += recipe.fat;
                    }
                });
            });
            
            document.getElementById('totalCalories').textContent = totalCalories;
            document.getElementById('totalProtein').textContent = totalProtein + 'g';
            document.getElementById('totalCarbs').textContent = totalCarbs + 'g';
            document.getElementById('totalFat').textContent = totalFat + 'g';
            
            nutritionSummary.style.display = 'block';
        }
        
        function clearMealPlan() {
            if (confirm('Are you sure you want to clear your entire meal plan?')) {
                mealPlan = {};
                const mealSlots = document.querySelectorAll('.meal-slot');
                mealSlots.forEach(slot => {
                    slot.innerHTML = slot.dataset.meal.charAt(0).toUpperCase() + slot.dataset.meal.slice(1);
                    slot.style.background = '';
                    slot.style.border = '';
                });
                
                document.getElementById('groceryList').style.display = 'none';
                document.getElementById('nutritionSummary').style.display = 'none';
                
                localStorage.removeItem('mealPlan');
            }
        }
        
        function saveMealPlan() {
            localStorage.setItem('mealPlan', JSON.stringify(mealPlan));
        }
        
        function loadMealPlan() {
            const saved = localStorage.getItem('mealPlan');
            if (saved) {
                mealPlan = JSON.parse(saved);
                
                Object.entries(mealPlan).forEach(([day, meals]) => {
                    Object.entries(meals).forEach(([meal, recipe]) => {
                        const mealSlot = document.querySelector(`[data-day="${day}"][data-meal="${meal}"]`);
                        if (mealSlot && recipe) {
                            mealSlot.innerHTML = `
                                <div style="font-weight: 600; color: var(--primary-color);">${recipe.title}</div>
                                <div style="font-size: 0.7rem; color: var(--text-secondary);">${recipe.calories} cal</div>
                            `;
                            mealSlot.style.background = 'rgba(99, 102, 241, 0.1)';
                            mealSlot.style.border = '2px solid var(--primary-color)';
                        }
                    });
                });
                
                updateNutritionSummary();
            }
        }
        
        function addNewRecipe() {
            const title = prompt('Recipe title:');
            if (!title) return;
            
            const category = prompt('Category (breakfast/lunch/dinner/snack):');
            if (!category) return;
            
            const calories = parseInt(prompt('Calories:') || '0');
            const protein = parseInt(prompt('Protein (g):') || '0');
            const carbs = parseInt(prompt('Carbs (g):') || '0');
            const fat = parseInt(prompt('Fat (g):') || '0');
            
            const ingredients = prompt('Ingredients (comma-separated):').split(',').map(i => i.trim());
            
            const newRecipe = {
                id: recipes.length + 1,
                title,
                category: category.toLowerCase(),
                tags: [],
                calories,
                protein,
                carbs,
                fat,
                ingredients
            };
            
            recipes.push(newRecipe);
            loadRecipes();
            alert('Recipe added successfully!');
        }
        
        // Search functionality
        document.getElementById('searchBox').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const recipeCards = document.querySelectorAll('.recipe-card');
            
            recipeCards.forEach(card => {
                const title = card.querySelector('.recipe-title').textContent.toLowerCase();
                if (title.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });
        
        // Category filtering
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const category = this.dataset.category;
                const recipeCards = document.querySelectorAll('.recipe-card');
                
                recipeCards.forEach(card => {
                    const recipe = recipes.find(r => r.id === parseInt(card.dataset.recipeId));
                    if (category === 'all' || recipe.category === category) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                });
            });
        });
    </script>
</body>
</html>
