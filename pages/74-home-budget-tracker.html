<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T69M8TNFWB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T69M8TNFWB');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Budget Tracker - GPT Ideas Hub</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .page-content { max-width: 1400px; margin: 0 auto; padding: 40px 20px; }
        .page-header { text-align: center; margin-bottom: 40px; padding: 40px 0; background: var(--gradient-primary); color: white; border-radius: var(--border-radius); position: relative; overflow: hidden; }
        .page-header::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>'); opacity: 0.3; }
        .page-header-content { position: relative; z-index: 2; }
        .page-title { font-size: 2.5rem; font-weight: 700; margin-bottom: 16px; font-family: 'Space Grotesk', sans-serif; }
        .page-meta { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .page-category-badge, .page-number-badge { padding: 8px 16px; background: rgba(255, 255, 255, 0.2); border-radius: 20px; font-size: 0.9rem; font-weight: 500; }
        .back-button { position: fixed; top: 20px; left: 20px; background: var(--primary-color); color: white; padding: 12px 20px; border-radius: var(--border-radius); text-decoration: none; font-weight: 500; transition: var(--transition); z-index: 1000; display: flex; align-items: center; gap: 8px; }
        .back-button:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        
        .budget-container { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 30px; }
        .overview-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        .transaction-panel { background: white; padding: 30px; border-radius: var(--border-radius); box-shadow: var(--shadow-md); }
        
        .form-section { margin-bottom: 30px; }
        .form-section h3 { color: var(--primary-color); margin-bottom: 15px; border-bottom: 2px solid var(--border-color); padding-bottom: 8px; }
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; font-weight: 500; margin-bottom: 8px; color: var(--text-primary); }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; transition: var(--transition); }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        .form-textarea { resize: vertical; min-height: 100px; }
        
        .overview-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .overview-card { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); text-align: center; border: 1px solid var(--border-color); }
        .overview-card.income { border-left: 4px solid #10b981; }
        .overview-card.expense { border-left: 4px solid #ef4444; }
        .overview-card.balance { border-left: 4px solid var(--primary-color); }
        .overview-card.budget { border-left: 4px solid #f59e0b; }
        .overview-value { font-size: 2rem; font-weight: 700; margin-bottom: 8px; }
        .overview-value.income { color: #10b981; }
        .overview-value.expense { color: #ef4444; }
        .overview-value.balance { color: var(--primary-color); }
        .overview-value.budget { color: #f59e0b; }
        .overview-label { font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase; font-weight: 500; }
        
        .budget-categories { margin-bottom: 30px; }
        .category-item { background: white; padding: 15px; border-radius: var(--border-radius); margin-bottom: 15px; border: 1px solid var(--border-color); }
        .category-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .category-name { font-weight: 600; color: var(--text-primary); }
        .category-amount { font-weight: 600; color: var(--primary-color); }
        .category-progress { background: var(--bg-tertiary); height: 8px; border-radius: 4px; overflow: hidden; margin-bottom: 8px; }
        .category-bar { height: 100%; background: var(--primary-color); transition: width 0.3s ease; }
        .category-bar.warning { background: #f59e0b; }
        .category-bar.danger { background: #ef4444; }
        .category-info { display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary); }
        
        .transaction-form { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-bottom: 20px; }
        .transaction-form-grid { display: grid; grid-template-columns: 1fr 1fr 1fr auto; gap: 15px; align-items: end; }
        
        .transaction-list { max-height: 400px; overflow-y: auto; }
        .transaction-item { display: flex; align-items: center; gap: 15px; padding: 12px; background: white; border-radius: var(--border-radius); margin-bottom: 10px; border: 1px solid var(--border-color); transition: var(--transition); }
        .transaction-item:hover { transform: translateY(-1px); box-shadow: var(--shadow-sm); }
        .transaction-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.2rem; }
        .transaction-icon.income { background: #10b981; }
        .transaction-icon.expense { background: #ef4444; }
        .transaction-details { flex: 1; }
        .transaction-title { font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
        .transaction-meta { font-size: 0.8rem; color: var(--text-secondary); }
        .transaction-amount { font-weight: 600; font-size: 1.1rem; }
        .transaction-amount.income { color: #10b981; }
        .transaction-amount.expense { color: #ef4444; }
        .transaction-actions { display: flex; gap: 5px; }
        .action-btn { width: 24px; height: 24px; border: none; background: var(--bg-tertiary); border-radius: var(--border-radius); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; transition: var(--transition); }
        .action-btn:hover { background: var(--primary-color); color: white; }
        .action-btn.delete:hover { background: #ef4444; }
        
        .chart-container { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-top: 20px; }
        .chart-placeholder { background: white; padding: 40px; border-radius: var(--border-radius); text-align: center; border: 2px dashed var(--border-color); }
        .chart-placeholder i { font-size: 3rem; color: var(--text-muted); margin-bottom: 15px; display: block; }
        
        .insights-panel { background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius); margin-top: 20px; }
        .insight-item { background: white; padding: 15px; border-radius: var(--border-radius); margin-bottom: 15px; border-left: 4px solid var(--primary-color); }
        .insight-title { font-weight: 600; color: var(--text-primary); margin-bottom: 8px; }
        .insight-description { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.4; }
        
        .action-buttons { display: flex; gap: 15px; margin-top: 30px; flex-wrap: wrap; }
        .btn-primary { background: var(--primary-color); color: white; border: none; padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); box-shadow: var(--shadow-lg); }
        .btn-secondary { background: var(--bg-secondary); color: var(--text-primary); border: 2px solid var(--border-color); padding: 12px 24px; border-radius: var(--border-radius); cursor: pointer; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 8px; }
        .btn-secondary:hover { background: var(--bg-tertiary); border-color: var(--primary-color); }
        
        .search-box { width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: var(--border-radius); font-size: 1rem; margin-bottom: 20px; }
        .search-box:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
        
        .filter-controls { display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; }
        .filter-btn { padding: 8px 16px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--border-radius); cursor: pointer; transition: var(--transition); font-size: 0.9rem; }
        .filter-btn:hover { background: var(--bg-tertiary); }
        .filter-btn.active { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        
        .month-selector { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .month-btn { width: 40px; height: 40px; border: 1px solid var(--border-color); background: white; border-radius: var(--border-radius); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: var(--transition); }
        .month-btn:hover { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .current-month { font-weight: 600; color: var(--primary-color); font-size: 1.1rem; }
        
        @media (max-width: 768px) {
            .page-title { font-size: 2rem; }
            .budget-container { grid-template-columns: 1fr; }
            .back-button { position: relative; top: auto; left: auto; margin-bottom: 20px; display: inline-block; }
            .transaction-form-grid { grid-template-columns: 1fr; }
            .overview-cards { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body class="individual-page">
    <a href="../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to Hub
    </a>
    
    <div class="container">
        <div class="page-content">
            <div class="page-header">
                <div class="page-header-content">
                    <h1 class="page-title">Home Budget Tracker</h1>
                    <div class="page-meta">
                        <span class="page-category-badge">Home & Lifestyle</span>
                        <span class="page-number-badge">Page #74</span>
                    </div>
                </div>
            </div>
            
            <div class="budget-container">
                <div class="overview-panel">
                    <div class="form-section">
                        <h3>Financial Overview</h3>
                        
                        <div class="month-selector">
                            <button class="month-btn" onclick="changeMonth(-1)">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div class="current-month" id="currentMonth">December 2024</div>
                            <button class="month-btn" onclick="changeMonth(1)">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <div class="overview-cards">
                            <div class="overview-card income">
                                <div class="overview-value income" id="totalIncome">$0.00</div>
                                <div class="overview-label">Total Income</div>
                            </div>
                            <div class="overview-card expense">
                                <div class="overview-value expense" id="totalExpense">$0.00</div>
                                <div class="overview-label">Total Expenses</div>
                            </div>
                            <div class="overview-card balance">
                                <div class="overview-value balance" id="netBalance">$0.00</div>
                                <div class="overview-label">Net Balance</div>
                            </div>
                            <div class="overview-card budget">
                                <div class="overview-value budget" id="budgetRemaining">$0.00</div>
                                <div class="overview-label">Budget Remaining</div>
                            </div>
                        </div>
                        
                        <div class="budget-categories" id="budgetCategories">
                            <!-- Budget categories will be populated here -->
                        </div>
                        
                        <div class="chart-container">
                            <h4>Spending by Category</h4>
                            <div class="chart-placeholder" id="categoryChart">
                                <i class="fas fa-chart-pie"></i>
                                <p>Category spending visualization will appear here</p>
                            </div>
                        </div>
                        
                        <div class="insights-panel">
                            <h4>Financial Insights</h4>
                            <div id="insightsList">
                                <!-- Insights will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="transaction-panel">
                    <div class="form-section">
                        <h3>Add Transaction</h3>
                        
                        <div class="transaction-form">
                            <div class="transaction-form-grid">
                                <div class="form-group">
                                    <label class="form-label">Description</label>
                                    <input type="text" class="form-input" id="transactionDescription" placeholder="e.g., Grocery shopping">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Amount ($)</label>
                                    <input type="number" class="form-input" id="transactionAmount" placeholder="0.00" step="0.01" min="0">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Category</label>
                                    <select class="form-select" id="transactionCategory">
                                        <option value="housing">Housing</option>
                                        <option value="food">Food & Dining</option>
                                        <option value="transportation">Transportation</option>
                                        <option value="utilities">Utilities</option>
                                        <option value="entertainment">Entertainment</option>
                                        <option value="healthcare">Healthcare</option>
                                        <option value="shopping">Shopping</option>
                                        <option value="income">Income</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <button class="btn-primary" onclick="addTransaction()">
                                    <i class="fas fa-plus"></i> Add
                                </button>
                            </div>
                        </div>
                        
                        <div class="filter-controls">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="income">Income</button>
                            <button class="filter-btn" data-filter="expense">Expenses</button>
                            <button class="filter-btn" data-filter="housing">Housing</button>
                            <button class="filter-btn" data-filter="food">Food</button>
                        </div>
                        
                        <input type="text" class="search-box" id="searchBox" placeholder="Search transactions...">
                        
                        <div class="transaction-list" id="transactionList">
                            <!-- Transactions will be populated here -->
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-primary" onclick="exportBudget()">
                                <i class="fas fa-download"></i> Export Budget
                            </button>
                            <button class="btn-secondary" onclick="setBudgetLimits()">
                                <i class="fas fa-cog"></i> Set Budget Limits
                            </button>
                            <button class="btn-secondary" onclick="clearTransactions()">
                                <i class="fas fa-trash"></i> Clear All
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Budget data structure
        let transactions = [];
        let budgetLimits = {
            housing: 1500,
            food: 600,
            transportation: 400,
            utilities: 300,
            entertainment: 200,
            healthcare: 300,
            shopping: 200,
            other: 100
        };
        let currentMonth = new Date();
        let activeFilter = 'all';
        
        // Category colors for charts
        const categoryColors = {
            housing: '#3b82f6',
            food: '#10b981',
            transportation: '#f59e0b',
            utilities: '#8b5cf6',
            entertainment: '#ef4444',
            healthcare: '#06b6d4',
            shopping: '#f97316',
            income: '#10b981',
            other: '#6b7280'
        };
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateCurrentMonth();
            renderBudgetOverview();
            renderTransactions();
            generateInsights();
        });
        
        function loadData() {
            const savedTransactions = localStorage.getItem('budgetTransactions');
            const savedBudgetLimits = localStorage.getItem('budgetLimits');
            
            if (savedTransactions) {
                transactions = JSON.parse(savedTransactions);
            }
            
            if (savedBudgetLimits) {
                budgetLimits = JSON.parse(savedBudgetLimits);
            }
        }
        
        function updateCurrentMonth() {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const month = monthNames[currentMonth.getMonth()];
            const year = currentMonth.getFullYear();
            document.getElementById('currentMonth').textContent = `${month} ${year}`;
        }
        
        function changeMonth(direction) {
            currentMonth.setMonth(currentMonth.getMonth() + direction);
            updateCurrentMonth();
            renderBudgetOverview();
            renderTransactions();
            generateInsights();
        }
        
        function renderBudgetOverview() {
            const currentMonthTransactions = getCurrentMonthTransactions();
            
            // Calculate totals
            const income = currentMonthTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const expenses = currentMonthTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const balance = income - expenses;
            const totalBudget = Object.values(budgetLimits).reduce((sum, limit) => sum + limit, 0);
            const budgetRemaining = totalBudget - expenses;
            
            // Update overview cards
            document.getElementById('totalIncome').textContent = `$${income.toFixed(2)}`;
            document.getElementById('totalExpense').textContent = `$${expenses.toFixed(2)}`;
            document.getElementById('netBalance').textContent = `$${balance.toFixed(2)}`;
            document.getElementById('budgetRemaining').textContent = `$${Math.max(0, budgetRemaining).toFixed(2)}`;
            
            // Render budget categories
            renderBudgetCategories(currentMonthTransactions);
        }
        
        function getCurrentMonthTransactions() {
            const currentMonthStart = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const currentMonthEnd = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0);
            
            return transactions.filter(t => {
                const transactionDate = new Date(t.date);
                return transactionDate >= currentMonthStart && transactionDate <= currentMonthEnd;
            });
        }
        
        function renderBudgetCategories(monthTransactions) {
            const categoriesContainer = document.getElementById('budgetCategories');
            categoriesContainer.innerHTML = '';
            
            Object.entries(budgetLimits).forEach(([category, limit]) => {
                if (category === 'income') return; // Skip income category for budget tracking
                
                const categoryExpenses = monthTransactions
                    .filter(t => t.type === 'expense' && t.category === category)
                    .reduce((sum, t) => sum + t.amount, 0);
                
                const percentage = (categoryExpenses / limit) * 100;
                let barClass = 'category-bar';
                if (percentage > 100) barClass += ' danger';
                else if (percentage > 80) barClass += ' warning';
                
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.innerHTML = `
                    <div class="category-header">
                        <span class="category-name">${category.charAt(0).toUpperCase() + category.slice(1)}</span>
                        <span class="category-amount">$${categoryExpenses.toFixed(2)} / $${limit.toFixed(2)}</span>
                    </div>
                    <div class="category-progress">
                        <div class="category-bar ${barClass}" style="width: ${Math.min(percentage, 100)}%"></div>
                    </div>
                    <div class="category-info">
                        <span>${percentage.toFixed(1)}% used</span>
                        <span>$${Math.max(0, limit - categoryExpenses).toFixed(2)} remaining</span>
                    </div>
                `;
                
                categoriesContainer.appendChild(categoryItem);
            });
        }
        
        function renderTransactions() {
            const transactionList = document.getElementById('transactionList');
            transactionList.innerHTML = '';
            
            const currentMonthTransactions = getCurrentMonthTransactions();
            const filteredTransactions = filterTransactions(currentMonthTransactions);
            
            if (filteredTransactions.length === 0) {
                transactionList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No transactions found</p>';
                return;
            }
            
            filteredTransactions.forEach(transaction => {
                const transactionElement = createTransactionElement(transaction);
                transactionList.appendChild(transactionElement);
            });
        }
        
        function filterTransactions(transactions) {
            switch (activeFilter) {
                case 'income':
                    return transactions.filter(t => t.type === 'income');
                case 'expense':
                    return transactions.filter(t => t.type === 'expense');
                case 'housing':
                    return transactions.filter(t => t.category === 'housing');
                case 'food':
                    return transactions.filter(t => t.category === 'food');
                default:
                    return transactions;
            }
        }
        
        function createTransactionElement(transaction) {
            const transactionElement = document.createElement('div');
            transactionElement.className = 'transaction-item';
            transactionElement.dataset.id = transaction.id;
            
            const iconClass = transaction.type === 'income' ? 'income' : 'expense';
            const icon = transaction.type === 'income' ? 'fa-plus' : 'fa-minus';
            
            transactionElement.innerHTML = `
                <div class="transaction-icon ${iconClass}">
                    <i class="fas ${icon}"></i>
                </div>
                <div class="transaction-details">
                    <div class="transaction-title">${transaction.description}</div>
                    <div class="transaction-meta">
                        ${transaction.category.charAt(0).toUpperCase() + transaction.category.slice(1)} • 
                        ${new Date(transaction.date).toLocaleDateString()}
                    </div>
                </div>
                <div class="transaction-amount ${iconClass}">
                    ${transaction.type === 'income' ? '+' : '-'}$${transaction.amount.toFixed(2)}
                </div>
                <div class="transaction-actions">
                    <button class="action-btn" onclick="editTransaction(${transaction.id})" title="Edit">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="action-btn delete" onclick="deleteTransaction(${transaction.id})" title="Delete">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;
            
            return transactionElement;
        }
        
        function addTransaction() {
            const description = document.getElementById('transactionDescription').value.trim();
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const category = document.getElementById('transactionCategory').value;
            
            if (!description || isNaN(amount) || amount <= 0) {
                alert('Please enter a valid description and amount');
                return;
            }
            
            const type = category === 'income' ? 'income' : 'expense';
            
            const newTransaction = {
                id: Date.now(),
                description,
                amount,
                category,
                type,
                date: new Date().toISOString(),
                createdAt: new Date().toISOString()
            };
            
            transactions.push(newTransaction);
            saveData();
            renderBudgetOverview();
            renderTransactions();
            generateInsights();
            
            // Clear form
            document.getElementById('transactionDescription').value = '';
            document.getElementById('transactionAmount').value = '';
            document.getElementById('transactionCategory').value = 'food';
        }
        
        function editTransaction(transactionId) {
            const transaction = transactions.find(t => t.id === transactionId);
            if (transaction) {
                document.getElementById('transactionDescription').value = transaction.description;
                document.getElementById('transactionAmount').value = transaction.amount;
                document.getElementById('transactionCategory').value = transaction.category;
                
                // Remove the old transaction
                deleteTransaction(transactionId);
                
                // Focus on description input for editing
                document.getElementById('transactionDescription').focus();
            }
        }
        
        function deleteTransaction(transactionId) {
            transactions = transactions.filter(t => t.id !== transactionId);
            saveData();
            renderBudgetOverview();
            renderTransactions();
            generateInsights();
        }
        
        function generateInsights() {
            const currentMonthTransactions = getCurrentMonthTransactions();
            const insightsList = document.getElementById('insightsList');
            insightsList.innerHTML = '';
            
            const insights = [];
            
            // Spending pattern insights
            const totalExpenses = currentMonthTransactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
            
            const totalIncome = currentMonthTransactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
            
            if (totalExpenses > totalIncome) {
                insights.push({
                    title: '⚠️ Overspending Alert',
                    description: `You're spending $${(totalExpenses - totalIncome).toFixed(2)} more than you're earning this month. Consider reducing expenses or increasing income.`
                });
            }
            
            // Category insights
            const categorySpending = {};
            currentMonthTransactions
                .filter(t => t.type === 'expense')
                .forEach(t => {
                    categorySpending[t.category] = (categorySpending[t.category] || 0) + t.amount;
                });
            
            Object.entries(categorySpending).forEach(([category, amount]) => {
                const limit = budgetLimits[category] || 0;
                if (amount > limit) {
                    insights.push({
                        title: `🚨 ${category.charAt(0).toUpperCase() + category.slice(1)} Over Budget`,
                        description: `You've exceeded your ${category} budget by $${(amount - limit).toFixed(2)}.`
                    });
                } else if (amount > limit * 0.8) {
                    insights.push({
                        title: `⚠️ ${category.charAt(0).toUpperCase() + category.slice(1)} Near Limit`,
                        description: `You're approaching your ${category} budget limit. Consider reducing spending in this category.`
                    });
                }
            });
            
            // Positive insights
            if (totalIncome > totalExpenses) {
                insights.push({
                    title: '✅ Good Financial Health',
                    description: `Great job! You're saving $${(totalIncome - totalExpenses).toFixed(2)} this month.`
                });
            }
            
            // Render insights
            insights.forEach(insight => {
                const insightElement = document.createElement('div');
                insightElement.className = 'insight-item';
                insightElement.innerHTML = `
                    <div class="insight-title">${insight.title}</div>
                    <div class="insight-description">${insight.description}</div>
                `;
                insightsList.appendChild(insightElement);
            });
            
            if (insights.length === 0) {
                insightsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No insights to display</p>';
            }
        }
        
        function setBudgetLimits() {
            const newLimits = {};
            Object.keys(budgetLimits).forEach(category => {
                if (category !== 'income') {
                    const newLimit = prompt(`Enter budget limit for ${category}:`, budgetLimits[category]);
                    if (newLimit && !isNaN(newLimit)) {
                        newLimits[category] = parseFloat(newLimit);
                    } else {
                        newLimits[category] = budgetLimits[category];
                    }
                }
            });
            
            budgetLimits = { ...budgetLimits, ...newLimits };
            saveData();
            renderBudgetOverview();
            generateInsights();
        }
        
        function clearTransactions() {
            if (confirm('Are you sure you want to clear all transactions? This action cannot be undone.')) {
                transactions = [];
                saveData();
                renderBudgetOverview();
                renderTransactions();
                generateInsights();
            }
        }
        
        function exportBudget() {
            if (transactions.length === 0) {
                alert('No transactions to export!');
                return;
            }
            
            let exportText = 'BUDGET REPORT\n';
            exportText += 'Generated on: ' + new Date().toLocaleDateString() + '\n';
            exportText += 'Period: ' + document.getElementById('currentMonth').textContent + '\n\n';
            
            exportText += 'OVERVIEW:\n';
            exportText += `Total Income: $${document.getElementById('totalIncome').textContent}\n`;
            exportText += `Total Expenses: $${document.getElementById('totalExpense').textContent}\n`;
            exportText += `Net Balance: $${document.getElementById('netBalance').textContent}\n\n`;
            
            exportText += 'TRANSACTIONS:\n';
            const currentMonthTransactions = getCurrentMonthTransactions();
            currentMonthTransactions.forEach(transaction => {
                const type = transaction.type === 'income' ? 'INCOME' : 'EXPENSE';
                const date = new Date(transaction.date).toLocaleDateString();
                exportText += `${date} | ${type} | ${transaction.category.toUpperCase()} | ${transaction.description} | $${transaction.amount.toFixed(2)}\n`;
            });
            
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'budget-report.txt';
            a.click();
            URL.revokeObjectURL(url);
        }
        
        function saveData() {
            localStorage.setItem('budgetTransactions', JSON.stringify(transactions));
            localStorage.setItem('budgetLimits', JSON.stringify(budgetLimits));
        }
        
        // Filter functionality
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                activeFilter = this.dataset.filter;
                renderTransactions();
            });
        });
        
        // Search functionality
        document.getElementById('searchBox').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const transactionItems = document.querySelectorAll('.transaction-item');
            
            transactionItems.forEach(item => {
                const description = item.querySelector('.transaction-title').textContent.toLowerCase();
                const category = item.querySelector('.transaction-meta').textContent.toLowerCase();
                
                if (description.includes(searchTerm) || category.includes(searchTerm)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
